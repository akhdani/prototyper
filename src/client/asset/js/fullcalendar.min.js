(function(factory){if(false&&typeof define==="function"&&define.amd){define(["jquery","moment"],factory)}else{factory(jQuery,moment)}})(function($,moment){var defaults={lang:"en",defaultTimedEventDuration:"02:00:00",defaultAllDayEventDuration:{days:1},forceEventDuration:false,nextDayThreshold:"09:00:00",defaultView:"month",aspectRatio:1.35,header:{left:"title",center:"",right:"today prev,next"},weekends:true,weekNumbers:false,weekNumberTitle:"W",weekNumberCalculation:"local",lazyFetching:true,startParam:"start",endParam:"end",timezoneParam:"timezone",timezone:false,titleFormat:{month:"MMMM YYYY",week:"ll",day:"LL"},columnFormat:{month:"ddd",week:generateWeekColumnFormat,day:"dddd"},timeFormat:{"default":generateShortTimeFormat},displayEventEnd:{month:false,basicWeek:false,"default":true},isRTL:false,defaultButtonText:{prev:"prev",next:"next",prevYear:"prev year",nextYear:"next year",today:"today",month:"month",week:"week",day:"day"},buttonIcons:{prev:"left-single-arrow",next:"right-single-arrow",prevYear:"left-double-arrow",nextYear:"right-double-arrow"},theme:false,themeButtonIcons:{prev:"circle-triangle-w",next:"circle-triangle-e",prevYear:"seek-prev",nextYear:"seek-next"},dragOpacity:.75,dragRevertDuration:500,dragScroll:true,unselectAuto:true,dropAccept:"*",eventLimit:false,eventLimitText:"more",eventLimitClick:"popover",dayPopoverFormat:"LL",handleWindowResize:true,windowResizeDelay:200};function generateShortTimeFormat(options,langData){return langData.longDateFormat("LT").replace(":mm","(:mm)").replace(/(\Wmm)$/,"($1)").replace(/\s*a$/i,"t")}function generateWeekColumnFormat(options,langData){var format=langData.longDateFormat("L");format=format.replace(/^Y+[^\w\s]*|[^\w\s]*Y+$/g,"");if(options.isRTL){format+=" ddd"}else{format="ddd "+format}return format}var langOptionHash={en:{columnFormat:{week:"ddd M/D"},dayPopoverFormat:"dddd, MMMM D"}};var rtlDefaults={header:{left:"next,prev today",center:"",right:"title"},buttonIcons:{prev:"right-single-arrow",next:"left-single-arrow",prevYear:"right-double-arrow",nextYear:"left-double-arrow"},themeButtonIcons:{prev:"circle-triangle-e",next:"circle-triangle-w",nextYear:"seek-prev",prevYear:"seek-next"}};var fc=$.fullCalendar={version:"2.1.1"};var fcViews=fc.views={};$.fn.fullCalendar=function(options){var args=Array.prototype.slice.call(arguments,1);var res=this;this.each(function(i,_element){var element=$(_element);var calendar=element.data("fullCalendar");var singleRes;if(typeof options==="string"){if(calendar&&$.isFunction(calendar[options])){singleRes=calendar[options].apply(calendar,args);if(!i){res=singleRes}if(options==="destroy"){element.removeData("fullCalendar")}}}else if(!calendar){calendar=new Calendar(element,options);element.data("fullCalendar",calendar);calendar.render()}});return res};function setDefaults(d){mergeOptions(defaults,d)}function mergeOptions(target){function mergeIntoTarget(name,value){if($.isPlainObject(value)&&$.isPlainObject(target[name])&&!isForcedAtomicOption(name)){target[name]=mergeOptions({},target[name],value)}else if(value!==undefined){target[name]=value}}for(var i=1;i<arguments.length;i++){$.each(arguments[i],mergeIntoTarget)}return target}function isForcedAtomicOption(name){return/(Time|Duration)$/.test(name)}fc.langs=langOptionHash;fc.datepickerLang=function(langCode,datepickerLangCode,options){var langOptions=langOptionHash[langCode];if(!langOptions){langOptions=langOptionHash[langCode]={}}mergeOptions(langOptions,{isRTL:options.isRTL,weekNumberTitle:options.weekHeader,titleFormat:{month:options.showMonthAfterYear?"YYYY["+options.yearSuffix+"] MMMM":"MMMM YYYY["+options.yearSuffix+"]"},defaultButtonText:{prev:stripHtmlEntities(options.prevText),next:stripHtmlEntities(options.nextText),today:stripHtmlEntities(options.currentText)}});if($.datepicker){$.datepicker.regional[datepickerLangCode]=$.datepicker.regional[langCode]=options;$.datepicker.regional.en=$.datepicker.regional[""];$.datepicker.setDefaults(options)}};fc.lang=function(langCode,options){var langOptions;if(options){langOptions=langOptionHash[langCode];if(!langOptions){langOptions=langOptionHash[langCode]={}}mergeOptions(langOptions,options||{})}defaults.lang=langCode};function Calendar(element,instanceOptions){var t=this;instanceOptions=instanceOptions||{};var options=mergeOptions({},defaults,instanceOptions);var langOptions;if(options.lang in langOptionHash){langOptions=langOptionHash[options.lang]}else{langOptions=langOptionHash[defaults.lang]}if(langOptions){options=mergeOptions({},defaults,langOptions,instanceOptions)}if(options.isRTL){options=mergeOptions({},defaults,rtlDefaults,langOptions||{},instanceOptions)}t.options=options;t.render=render;t.destroy=destroy;t.refetchEvents=refetchEvents;t.reportEvents=reportEvents;t.reportEventChange=reportEventChange;t.rerenderEvents=renderEvents;t.changeView=changeView;t.select=select;t.unselect=unselect;t.prev=prev;t.next=next;t.prevYear=prevYear;t.nextYear=nextYear;t.today=today;t.gotoDate=gotoDate;t.incrementDate=incrementDate;t.zoomTo=zoomTo;t.getDate=getDate;t.getCalendar=getCalendar;t.getView=getView;t.option=option;t.trigger=trigger;function getLocaleData(langCode){var f=moment.localeData||moment.langData;return f.call(moment,langCode)||f.call(moment,"en")}var localeData=createObject(getLocaleData(options.lang));if(options.monthNames){localeData._months=options.monthNames}if(options.monthNamesShort){localeData._monthsShort=options.monthNamesShort}if(options.dayNames){localeData._weekdays=options.dayNames}if(options.dayNamesShort){localeData._weekdaysShort=options.dayNamesShort}if(options.firstDay!=null){var _week=createObject(localeData._week);_week.dow=options.firstDay;localeData._week=_week}t.defaultAllDayEventDuration=moment.duration(options.defaultAllDayEventDuration);t.defaultTimedEventDuration=moment.duration(options.defaultTimedEventDuration);t.moment=function(){var mom;if(options.timezone==="local"){mom=fc.moment.apply(null,arguments);if(mom.hasTime()){mom.local()}}else if(options.timezone==="UTC"){mom=fc.moment.utc.apply(null,arguments)}else{mom=fc.moment.parseZone.apply(null,arguments)}if("_locale"in mom){mom._locale=localeData}else{mom._lang=localeData}return mom};t.getIsAmbigTimezone=function(){return options.timezone!=="local"&&options.timezone!=="UTC"};t.rezoneDate=function(date){return t.moment(date.toArray())};t.getNow=function(){var now=options.now;if(typeof now==="function"){now=now()}return t.moment(now)};t.calculateWeekNumber=function(mom){var calc=options.weekNumberCalculation;if(typeof calc==="function"){return calc(mom)}else if(calc==="local"){return mom.week()}else if(calc.toUpperCase()==="ISO"){return mom.isoWeek()}};t.getEventEnd=function(event){if(event.end){return event.end.clone()}else{return t.getDefaultEventEnd(event.allDay,event.start)}};t.getDefaultEventEnd=function(allDay,start){var end=start.clone();if(allDay){end.stripTime().add(t.defaultAllDayEventDuration)}else{end.add(t.defaultTimedEventDuration)}if(t.getIsAmbigTimezone()){end.stripZone()}return end};t.formatRange=function(m1,m2,formatStr){if(typeof formatStr==="function"){formatStr=formatStr.call(t,options,localeData)}return formatRange(m1,m2,formatStr,null,options.isRTL)};t.formatDate=function(mom,formatStr){if(typeof formatStr==="function"){formatStr=formatStr.call(t,options,localeData)}return formatDate(mom,formatStr)};EventManager.call(t,options);var isFetchNeeded=t.isFetchNeeded;var fetchEvents=t.fetchEvents;var _element=element[0];var header;var headerElement;var content;var tm;var currentView;var suggestedViewHeight;var windowResizeProxy;var ignoreWindowResize=0;var date;var events=[];if(options.defaultDate!=null){date=t.moment(options.defaultDate)}else{date=t.getNow()}function render(inc){if(!content){initialRender()}else if(elementVisible()){calcSize();renderView(inc)}}function initialRender(){tm=options.theme?"ui":"fc";element.addClass("fc");if(options.isRTL){element.addClass("fc-rtl")}else{element.addClass("fc-ltr")}if(options.theme){element.addClass("ui-widget")}else{element.addClass("fc-unthemed")}content=$("<div class='fc-view-container'/>").prependTo(element);header=new Header(t,options);headerElement=header.render();if(headerElement){element.prepend(headerElement)}changeView(options.defaultView);if(options.handleWindowResize){windowResizeProxy=debounce(windowResize,options.windowResizeDelay);$(window).resize(windowResizeProxy)}}function destroy(){if(currentView){currentView.destroy()}header.destroy();content.remove();element.removeClass("fc fc-ltr fc-rtl fc-unthemed ui-widget");$(window).unbind("resize",windowResizeProxy)}function elementVisible(){return element.is(":visible")}function changeView(viewName){renderView(0,viewName)}function renderView(delta,viewName){ignoreWindowResize++;if(currentView&&viewName&&currentView.name!==viewName){header.deactivateButton(currentView.name);freezeContentHeight();if(currentView.start){currentView.destroy()}currentView.el.remove();currentView=null}if(!currentView&&viewName){currentView=new fcViews[viewName](t);currentView.el=$("<div class='fc-view fc-"+viewName+"-view' />").appendTo(content);header.activateButton(viewName)}if(currentView){if(delta){date=currentView.incrementDate(date,delta)}if(!currentView.start||delta||!date.isWithin(currentView.intervalStart,currentView.intervalEnd)){if(elementVisible()){freezeContentHeight();if(currentView.start){currentView.destroy()}currentView.render(date);unfreezeContentHeight();updateTitle();updateTodayButton();getAndRenderEvents()}}}unfreezeContentHeight();ignoreWindowResize--}t.getSuggestedViewHeight=function(){if(suggestedViewHeight===undefined){calcSize()}return suggestedViewHeight};t.isHeightAuto=function(){return options.contentHeight==="auto"||options.height==="auto"};function updateSize(shouldRecalc){if(elementVisible()){if(shouldRecalc){_calcSize()}ignoreWindowResize++;currentView.updateSize(true);ignoreWindowResize--;return true}}function calcSize(){if(elementVisible()){_calcSize()}}function _calcSize(){if(typeof options.contentHeight==="number"){suggestedViewHeight=options.contentHeight}else if(typeof options.height==="number"){suggestedViewHeight=options.height-(headerElement?headerElement.outerHeight(true):0)}else{suggestedViewHeight=Math.round(content.width()/Math.max(options.aspectRatio,.5))}}function windowResize(ev){if(!ignoreWindowResize&&ev.target===window&&currentView.start){if(updateSize(true)){currentView.trigger("windowResize",_element)}}}function refetchEvents(){destroyEvents();fetchAndRenderEvents()}function renderEvents(){if(elementVisible()){freezeContentHeight();currentView.destroyEvents();currentView.renderEvents(events);unfreezeContentHeight()}}function destroyEvents(){freezeContentHeight();currentView.destroyEvents();unfreezeContentHeight()}function getAndRenderEvents(){if(!options.lazyFetching||isFetchNeeded(currentView.start,currentView.end)){fetchAndRenderEvents()}else{renderEvents()}}function fetchAndRenderEvents(){fetchEvents(currentView.start,currentView.end)}function reportEvents(_events){events=_events;renderEvents()}function reportEventChange(){renderEvents()}function updateTitle(){header.updateTitle(currentView.title)}function updateTodayButton(){var now=t.getNow();if(now.isWithin(currentView.intervalStart,currentView.intervalEnd)){header.disableButton("today")}else{header.enableButton("today")}}function select(start,end){start=t.moment(start);if(end){end=t.moment(end)}else if(start.hasTime()){end=start.clone().add(t.defaultTimedEventDuration)}else{end=start.clone().add(t.defaultAllDayEventDuration)}currentView.select(start,end)}function unselect(){if(currentView){currentView.unselect()}}function prev(){renderView(-1)}function next(){renderView(1)}function prevYear(){date.add(-1,"years");renderView()}function nextYear(){date.add(1,"years");renderView()}function today(){date=t.getNow();renderView()}function gotoDate(dateInput){date=t.moment(dateInput);renderView()}function incrementDate(delta){date.add(moment.duration(delta));renderView()}function zoomTo(newDate,viewName){var viewStr;var match;if(!viewName||fcViews[viewName]===undefined){viewName=viewName||"day";viewStr=header.getViewsWithButtons().join(" ");match=viewStr.match(new RegExp("\\w+"+capitaliseFirstLetter(viewName)));if(!match){match=viewStr.match(/\w+Day/)}viewName=match?match[0]:"agendaDay"}date=newDate;changeView(viewName)}function getDate(){return date.clone()}function freezeContentHeight(){content.css({width:"100%",height:content.height(),overflow:"hidden"})}function unfreezeContentHeight(){content.css({width:"",height:"",overflow:""})}function getCalendar(){return t}function getView(){return currentView}function option(name,value){if(value===undefined){return options[name]}if(name=="height"||name=="contentHeight"||name=="aspectRatio"){options[name]=value;updateSize(true)}}function trigger(name,thisObj){if(options[name]){return options[name].apply(thisObj||_element,Array.prototype.slice.call(arguments,2))}}}function Header(calendar,options){var t=this;t.render=render;t.destroy=destroy;t.updateTitle=updateTitle;t.activateButton=activateButton;t.deactivateButton=deactivateButton;t.disableButton=disableButton;t.enableButton=enableButton;t.getViewsWithButtons=getViewsWithButtons;var el=$();var viewsWithButtons=[];var tm;function render(){var sections=options.header;tm=options.theme?"ui":"fc";if(sections){el=$("<div class='fc-toolbar'/>").append(renderSection("left")).append(renderSection("right")).append(renderSection("center")).append('<div class="fc-clear"/>');return el}}function destroy(){el.remove()}function renderSection(position){var sectionEl=$('<div class="fc-'+position+'"/>');var buttonStr=options.header[position];if(buttonStr){$.each(buttonStr.split(" "),function(i){var groupChildren=$();var isOnlyButtons=true;var groupEl;$.each(this.split(","),function(j,buttonName){var buttonClick;var themeIcon;var normalIcon;var defaultText;var customText;var innerHtml;var classes;var button;if(buttonName=="title"){groupChildren=groupChildren.add($("<h2>&nbsp;</h2>"));isOnlyButtons=false}else{if(calendar[buttonName]){buttonClick=function(){calendar[buttonName]()}}else if(fcViews[buttonName]){buttonClick=function(){calendar.changeView(buttonName)};viewsWithButtons.push(buttonName)}if(buttonClick){themeIcon=smartProperty(options.themeButtonIcons,buttonName);normalIcon=smartProperty(options.buttonIcons,buttonName);defaultText=smartProperty(options.defaultButtonText,buttonName);customText=smartProperty(options.buttonText,buttonName);if(customText){innerHtml=htmlEscape(customText)}else if(themeIcon&&options.theme){innerHtml="<span class='ui-icon ui-icon-"+themeIcon+"'></span>"}else if(normalIcon&&!options.theme){innerHtml="<span class='fc-icon fc-icon-"+normalIcon+"'></span>"}else{innerHtml=htmlEscape(defaultText||buttonName)}classes=["fc-"+buttonName+"-button",tm+"-button",tm+"-state-default"];button=$('<button type="button" class="'+classes.join(" ")+'">'+innerHtml+"</button>").click(function(){if(!button.hasClass(tm+"-state-disabled")){buttonClick();if(button.hasClass(tm+"-state-active")||button.hasClass(tm+"-state-disabled")){button.removeClass(tm+"-state-hover")}}}).mousedown(function(){button.not("."+tm+"-state-active").not("."+tm+"-state-disabled").addClass(tm+"-state-down")}).mouseup(function(){button.removeClass(tm+"-state-down")}).hover(function(){button.not("."+tm+"-state-active").not("."+tm+"-state-disabled").addClass(tm+"-state-hover")},function(){button.removeClass(tm+"-state-hover").removeClass(tm+"-state-down")});groupChildren=groupChildren.add(button)}}});if(isOnlyButtons){groupChildren.first().addClass(tm+"-corner-left").end().last().addClass(tm+"-corner-right").end()}if(groupChildren.length>1){groupEl=$("<div/>");if(isOnlyButtons){groupEl.addClass("fc-button-group")}groupEl.append(groupChildren);sectionEl.append(groupEl)}else{sectionEl.append(groupChildren)}})}return sectionEl}function updateTitle(text){el.find("h2").text(text)}function activateButton(buttonName){el.find(".fc-"+buttonName+"-button").addClass(tm+"-state-active")}function deactivateButton(buttonName){el.find(".fc-"+buttonName+"-button").removeClass(tm+"-state-active")}function disableButton(buttonName){el.find(".fc-"+buttonName+"-button").attr("disabled","disabled").addClass(tm+"-state-disabled")}function enableButton(buttonName){el.find(".fc-"+buttonName+"-button").removeAttr("disabled").removeClass(tm+"-state-disabled")}function getViewsWithButtons(){return viewsWithButtons}}fc.sourceNormalizers=[];fc.sourceFetchers=[];var ajaxDefaults={dataType:"json",cache:false};var eventGUID=1;function EventManager(options){var t=this;t.isFetchNeeded=isFetchNeeded;t.fetchEvents=fetchEvents;t.addEventSource=addEventSource;t.removeEventSource=removeEventSource;t.updateEvent=updateEvent;t.renderEvent=renderEvent;t.removeEvents=removeEvents;t.clientEvents=clientEvents;t.mutateEvent=mutateEvent;var trigger=t.trigger;var getView=t.getView;var reportEvents=t.reportEvents;var getEventEnd=t.getEventEnd;var stickySource={events:[]};var sources=[stickySource];var rangeStart,rangeEnd;var currentFetchID=0;var pendingSourceCnt=0;var loadingLevel=0;var cache=[];$.each((options.events?[options.events]:[]).concat(options.eventSources||[]),function(i,sourceInput){var source=buildEventSource(sourceInput);if(source){sources.push(source)}});function isFetchNeeded(start,end){return!rangeStart||start.clone().stripZone()<rangeStart.clone().stripZone()||end.clone().stripZone()>rangeEnd.clone().stripZone()}function fetchEvents(start,end){rangeStart=start;rangeEnd=end;cache=[];var fetchID=++currentFetchID;var len=sources.length;pendingSourceCnt=len;for(var i=0;i<len;i++){fetchEventSource(sources[i],fetchID)}}function fetchEventSource(source,fetchID){_fetchEventSource(source,function(events){var isArraySource=$.isArray(source.events);var i;var event;if(fetchID==currentFetchID){if(events){for(i=0;i<events.length;i++){event=events[i];if(!isArraySource){event=buildEvent(event,source)}if(event){cache.push(event)}}}pendingSourceCnt--;if(!pendingSourceCnt){reportEvents(cache)}}})}function _fetchEventSource(source,callback){var i;var fetchers=fc.sourceFetchers;var res;for(i=0;i<fetchers.length;i++){res=fetchers[i].call(t,source,rangeStart.clone(),rangeEnd.clone(),options.timezone,callback);if(res===true){return}else if(typeof res=="object"){_fetchEventSource(res,callback);return}}var events=source.events;if(events){if($.isFunction(events)){pushLoading();events.call(t,rangeStart.clone(),rangeEnd.clone(),options.timezone,function(events){callback(events);popLoading()})}else if($.isArray(events)){callback(events)}else{callback()}}else{var url=source.url;if(url){var success=source.success;var error=source.error;var complete=source.complete;var customData;if($.isFunction(source.data)){customData=source.data()}else{customData=source.data}var data=$.extend({},customData||{});var startParam=firstDefined(source.startParam,options.startParam);var endParam=firstDefined(source.endParam,options.endParam);var timezoneParam=firstDefined(source.timezoneParam,options.timezoneParam);if(startParam){data[startParam]=rangeStart.format()}if(endParam){data[endParam]=rangeEnd.format()}if(options.timezone&&options.timezone!="local"){data[timezoneParam]=options.timezone}pushLoading();$.ajax($.extend({},ajaxDefaults,source,{data:data,success:function(events){events=events||[];var res=applyAll(success,this,arguments);if($.isArray(res)){events=res}callback(events)},error:function(){applyAll(error,this,arguments);callback()},complete:function(){applyAll(complete,this,arguments);popLoading()}}))}else{callback()}}}function addEventSource(sourceInput){var source=buildEventSource(sourceInput);if(source){sources.push(source);pendingSourceCnt++;fetchEventSource(source,currentFetchID)}}function buildEventSource(sourceInput){var normalizers=fc.sourceNormalizers;var source;var i;if($.isFunction(sourceInput)||$.isArray(sourceInput)){source={events:sourceInput}}else if(typeof sourceInput==="string"){source={url:sourceInput}}else if(typeof sourceInput==="object"){source=$.extend({},sourceInput)}if(source){if(source.className){if(typeof source.className==="string"){source.className=source.className.split(/\s+/)}}else{source.className=[]}if($.isArray(source.events)){source.origArray=source.events;source.events=$.map(source.events,function(eventInput){return buildEvent(eventInput,source)})}for(i=0;i<normalizers.length;i++){normalizers[i].call(t,source)}return source}}function removeEventSource(source){sources=$.grep(sources,function(src){return!isSourcesEqual(src,source)});cache=$.grep(cache,function(e){return!isSourcesEqual(e.source,source)});reportEvents(cache)}function isSourcesEqual(source1,source2){return source1&&source2&&getSourcePrimitive(source1)==getSourcePrimitive(source2)}function getSourcePrimitive(source){return(typeof source==="object"?source.origArray||source.url||source.events:null)||source}function updateEvent(event){event.start=t.moment(event.start);if(event.end){event.end=t.moment(event.end)}mutateEvent(event);propagateMiscProperties(event);reportEvents(cache)}var miscCopyableProps=["title","url","allDay","className","editable","color","backgroundColor","borderColor","textColor"];function propagateMiscProperties(event){var i;var cachedEvent;var j;var prop;for(i=0;i<cache.length;i++){cachedEvent=cache[i];if(cachedEvent._id==event._id&&cachedEvent!==event){for(j=0;j<miscCopyableProps.length;j++){prop=miscCopyableProps[j];if(event[prop]!==undefined){cachedEvent[prop]=event[prop]}}}}}function renderEvent(eventData,stick){var event=buildEvent(eventData);if(event){if(!event.source){if(stick){stickySource.events.push(event);event.source=stickySource}cache.push(event)}reportEvents(cache)}}function removeEvents(filter){var eventID;var i;if(filter==null){filter=function(){return true}}else if(!$.isFunction(filter)){eventID=filter+"";filter=function(event){return event._id==eventID}}cache=$.grep(cache,filter,true);for(i=0;i<sources.length;i++){if($.isArray(sources[i].events)){sources[i].events=$.grep(sources[i].events,filter,true)}}reportEvents(cache)}function clientEvents(filter){if($.isFunction(filter)){return $.grep(cache,filter)}else if(filter!=null){filter+="";return $.grep(cache,function(e){return e._id==filter})}return cache}function pushLoading(){if(!loadingLevel++){trigger("loading",null,true,getView())}}function popLoading(){if(!--loadingLevel){trigger("loading",null,false,getView())}}function buildEvent(data,source){var out={};var start;var end;var allDay;var allDayDefault;if(options.eventDataTransform){data=options.eventDataTransform(data)}if(source&&source.eventDataTransform){data=source.eventDataTransform(data)}start=t.moment(data.start||data.date);if(!start.isValid()){return}end=null;if(data.end){end=t.moment(data.end);if(!end.isValid()){return}}allDay=data.allDay;if(allDay===undefined){allDayDefault=firstDefined(source?source.allDayDefault:undefined,options.allDayDefault);if(allDayDefault!==undefined){allDay=allDayDefault}else{allDay=!start.hasTime()&&(!end||!end.hasTime())}}if(allDay){if(start.hasTime()){start.stripTime()}if(end&&end.hasTime()){end.stripTime()}}else{if(!start.hasTime()){start=t.rezoneDate(start)}if(end&&!end.hasTime()){end=t.rezoneDate(end)}}$.extend(out,data);if(source){out.source=source}out._id=data._id||(data.id===undefined?"_fc"+eventGUID++:data.id+"");if(data.className){if(typeof data.className=="string"){out.className=data.className.split(/\s+/)}else{out.className=data.className}}else{out.className=[]}out.allDay=allDay;out.start=start;out.end=end;if(options.forceEventDuration&&!out.end){out.end=getEventEnd(out)}backupEventDates(out);return out}function mutateEvent(event,newStart,newEnd){var oldAllDay=event._allDay;var oldStart=event._start;var oldEnd=event._end;var clearEnd=false;var newAllDay;var dateDelta;var durationDelta;var undoFunc;if(!newStart&&!newEnd){newStart=event.start;newEnd=event.end}if(event.allDay!=oldAllDay){newAllDay=event.allDay}else{newAllDay=!(newStart||newEnd).hasTime()}if(newAllDay){if(newStart){newStart=newStart.clone().stripTime()}if(newEnd){newEnd=newEnd.clone().stripTime()}}if(newStart){if(newAllDay){dateDelta=dayishDiff(newStart,oldStart.clone().stripTime())}else{dateDelta=dayishDiff(newStart,oldStart)}}if(newAllDay!=oldAllDay){clearEnd=true}else if(newEnd){durationDelta=dayishDiff(newEnd||t.getDefaultEventEnd(newAllDay,newStart||oldStart),newStart||oldStart).subtract(dayishDiff(oldEnd||t.getDefaultEventEnd(oldAllDay,oldStart),oldStart))}undoFunc=mutateEvents(clientEvents(event._id),clearEnd,newAllDay,dateDelta,durationDelta);return{dateDelta:dateDelta,durationDelta:durationDelta,undo:undoFunc}}function mutateEvents(events,clearEnd,forceAllDay,dateDelta,durationDelta){var isAmbigTimezone=t.getIsAmbigTimezone();var undoFunctions=[];$.each(events,function(i,event){var oldAllDay=event._allDay;var oldStart=event._start;var oldEnd=event._end;var newAllDay=forceAllDay!=null?forceAllDay:oldAllDay;var newStart=oldStart.clone();var newEnd=!clearEnd&&oldEnd?oldEnd.clone():null;if(newAllDay){newStart.stripTime();if(newEnd){newEnd.stripTime()}}else{if(!newStart.hasTime()){newStart=t.rezoneDate(newStart)}if(newEnd&&!newEnd.hasTime()){newEnd=t.rezoneDate(newEnd)}}if(!newEnd&&(options.forceEventDuration||+durationDelta)){newEnd=t.getDefaultEventEnd(newAllDay,newStart)}newStart.add(dateDelta);if(newEnd){newEnd.add(dateDelta).add(durationDelta)}if(isAmbigTimezone){if(+dateDelta||+durationDelta){newStart.stripZone();if(newEnd){newEnd.stripZone()}}}event.allDay=newAllDay;event.start=newStart;event.end=newEnd;backupEventDates(event);undoFunctions.push(function(){event.allDay=oldAllDay;event.start=oldStart;event.end=oldEnd;backupEventDates(event)})});return function(){for(var i=0;i<undoFunctions.length;i++){undoFunctions[i]()}}}}function backupEventDates(event){event._allDay=event.allDay;event._start=event.start.clone();event._end=event.end?event.end.clone():null}function compensateScroll(rowEls,scrollbarWidths){if(scrollbarWidths.left){rowEls.css({"border-left-width":1,"margin-left":scrollbarWidths.left-1})}if(scrollbarWidths.right){rowEls.css({"border-right-width":1,"margin-right":scrollbarWidths.right-1})}}function uncompensateScroll(rowEls){rowEls.css({"margin-left":"","margin-right":"","border-left-width":"","border-right-width":""})}function distributeHeight(els,availableHeight,shouldRedistribute){var minOffset1=Math.floor(availableHeight/els.length);var minOffset2=Math.floor(availableHeight-minOffset1*(els.length-1));var flexEls=[];var flexOffsets=[];var flexHeights=[];var usedHeight=0;undistributeHeight(els);els.each(function(i,el){var minOffset=i===els.length-1?minOffset2:minOffset1;var naturalOffset=$(el).outerHeight(true);if(naturalOffset<minOffset){flexEls.push(el);flexOffsets.push(naturalOffset);flexHeights.push($(el).height())}else{usedHeight+=naturalOffset}});if(shouldRedistribute){availableHeight-=usedHeight;minOffset1=Math.floor(availableHeight/flexEls.length);minOffset2=Math.floor(availableHeight-minOffset1*(flexEls.length-1))}$(flexEls).each(function(i,el){var minOffset=i===flexEls.length-1?minOffset2:minOffset1;var naturalOffset=flexOffsets[i];var naturalHeight=flexHeights[i];var newHeight=minOffset-(naturalOffset-naturalHeight);if(naturalOffset<minOffset){$(el).height(newHeight)}})}function undistributeHeight(els){els.height("")}function matchCellWidths(els){var maxInnerWidth=0;els.find("> *").each(function(i,innerEl){var innerWidth=$(innerEl).outerWidth();if(innerWidth>maxInnerWidth){maxInnerWidth=innerWidth}});maxInnerWidth++;els.width(maxInnerWidth);return maxInnerWidth}function setPotentialScroller(containerEl,height){containerEl.height(height).addClass("fc-scroller");if(containerEl[0].scrollHeight-1>containerEl[0].clientHeight){return true}unsetScroller(containerEl);return false}function unsetScroller(containerEl){containerEl.height("").removeClass("fc-scroller")}function getScrollParent(el){var position=el.css("position"),scrollParent=el.parents().filter(function(){var parent=$(this);return/(auto|scroll)/.test(parent.css("overflow")+parent.css("overflow-y")+parent.css("overflow-x"))}).eq(0);return position==="fixed"||!scrollParent.length?$(el[0].ownerDocument||document):scrollParent}function getScrollbarWidths(container){var containerLeft=container.offset().left;var containerRight=containerLeft+container.width();var inner=container.children();var innerLeft=inner.offset().left;var innerRight=innerLeft+inner.outerWidth();return{left:innerLeft-containerLeft,right:containerRight-innerRight}}function isPrimaryMouseButton(ev){return ev.which==1&&!ev.ctrlKey}function intersectionToSeg(subjectStart,subjectEnd,intervalStart,intervalEnd){var segStart,segEnd;var isStart,isEnd;if(subjectEnd>intervalStart&&subjectStart<intervalEnd){if(subjectStart>=intervalStart){segStart=subjectStart.clone();isStart=true}else{segStart=intervalStart.clone();isStart=false}if(subjectEnd<=intervalEnd){segEnd=subjectEnd.clone();isEnd=true}else{segEnd=intervalEnd.clone();isEnd=false}return{start:segStart,end:segEnd,isStart:isStart,isEnd:isEnd}}}function smartProperty(obj,name){obj=obj||{};if(obj[name]!==undefined){return obj[name]}var parts=name.split(/(?=[A-Z])/),i=parts.length-1,res;for(;i>=0;i--){res=obj[parts[i].toLowerCase()];if(res!==undefined){return res}}return obj["default"]}var dayIDs=["sun","mon","tue","wed","thu","fri","sat"];function dayishDiff(a,b){return moment.duration({days:a.clone().stripTime().diff(b.clone().stripTime(),"days"),ms:a.time()-b.time()})}function isNativeDate(input){return Object.prototype.toString.call(input)==="[object Date]"||input instanceof Date}function dateCompare(a,b){return a-b}fc.applyAll=applyAll;function createObject(proto){var f=function(){};f.prototype=proto;return new f}function extend(a,b){for(var i in b){if(b.hasOwnProperty(i)){a[i]=b[i]}}}function applyAll(functions,thisObj,args){if($.isFunction(functions)){functions=[functions]}if(functions){var i;var ret;for(i=0;i<functions.length;i++){ret=functions[i].apply(thisObj,args)||ret}return ret}}function firstDefined(){for(var i=0;i<arguments.length;i++){if(arguments[i]!==undefined){return arguments[i]}}}function htmlEscape(s){return(s+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#039;").replace(/"/g,"&quot;").replace(/\n/g,"<br />")}function stripHtmlEntities(text){return text.replace(/&.*?;/g,"")}function capitaliseFirstLetter(str){return str.charAt(0).toUpperCase()+str.slice(1)}function debounce(func,wait){var timeoutId;var args;var context;var timestamp;var later=function(){var last=+new Date-timestamp;if(last<wait&&last>0){timeoutId=setTimeout(later,wait-last)}else{timeoutId=null;func.apply(context,args);if(!timeoutId){context=args=null}}};return function(){context=this;args=arguments;timestamp=+new Date;if(!timeoutId){timeoutId=setTimeout(later,wait)}}}var ambigDateOfMonthRegex=/^\s*\d{4}-\d\d$/;var ambigTimeOrZoneRegex=/^\s*\d{4}-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?)?$/;fc.moment=function(){return makeMoment(arguments)};fc.moment.utc=function(){var mom=makeMoment(arguments,true);if(mom.hasTime()){mom.utc()}return mom};fc.moment.parseZone=function(){return makeMoment(arguments,true,true)};function makeMoment(args,parseAsUTC,parseZone){var input=args[0];var isSingleString=args.length==1&&typeof input==="string";var isAmbigTime;var isAmbigZone;var ambigMatch;var output;if(moment.isMoment(input)){output=moment.apply(null,args);if(input._ambigTime){output._ambigTime=true}if(input._ambigZone){output._ambigZone=true}}else if(isNativeDate(input)||input===undefined){output=moment.apply(null,args)}else{isAmbigTime=false;isAmbigZone=false;if(isSingleString){if(ambigDateOfMonthRegex.test(input)){input+="-01";args=[input];isAmbigTime=true;isAmbigZone=true}else if(ambigMatch=ambigTimeOrZoneRegex.exec(input)){isAmbigTime=!ambigMatch[5];isAmbigZone=true}}else if($.isArray(input)){isAmbigZone=true}if(parseAsUTC){output=moment.utc.apply(moment,args)}else{output=moment.apply(null,args)}if(isAmbigTime){output._ambigTime=true;
output._ambigZone=true}else if(parseZone){if(isAmbigZone){output._ambigZone=true}else if(isSingleString){output.zone(input)}}}return new FCMoment(output)}function FCMoment(internalData){extend(this,internalData)}FCMoment.prototype=createObject(moment.fn);FCMoment.prototype.clone=function(){return makeMoment([this])};FCMoment.prototype.time=function(time){if(time==null){return moment.duration({hours:this.hours(),minutes:this.minutes(),seconds:this.seconds(),milliseconds:this.milliseconds()})}else{delete this._ambigTime;if(!moment.isDuration(time)&&!moment.isMoment(time)){time=moment.duration(time)}var dayHours=0;if(moment.isDuration(time)){dayHours=Math.floor(time.asDays())*24}return this.hours(dayHours+time.hours()).minutes(time.minutes()).seconds(time.seconds()).milliseconds(time.milliseconds())}};FCMoment.prototype.stripTime=function(){var a=this.toArray();moment.fn.utc.call(this);this.year(a[0]).month(a[1]).date(a[2]).hours(0).minutes(0).seconds(0).milliseconds(0);this._ambigTime=true;this._ambigZone=true;return this};FCMoment.prototype.hasTime=function(){return!this._ambigTime};FCMoment.prototype.stripZone=function(){var a=this.toArray();var wasAmbigTime=this._ambigTime;moment.fn.utc.call(this);this.year(a[0]).month(a[1]).date(a[2]).hours(a[3]).minutes(a[4]).seconds(a[5]).milliseconds(a[6]);if(wasAmbigTime){this._ambigTime=true}this._ambigZone=true;return this};FCMoment.prototype.hasZone=function(){return!this._ambigZone};FCMoment.prototype.zone=function(tzo){if(tzo!=null){delete this._ambigTime;delete this._ambigZone}return moment.fn.zone.apply(this,arguments)};FCMoment.prototype.local=function(){var a=this.toArray();var wasAmbigZone=this._ambigZone;delete this._ambigTime;delete this._ambigZone;moment.fn.local.apply(this,arguments);if(wasAmbigZone){this.year(a[0]).month(a[1]).date(a[2]).hours(a[3]).minutes(a[4]).seconds(a[5]).milliseconds(a[6])}return this};FCMoment.prototype.utc=function(){delete this._ambigTime;delete this._ambigZone;return moment.fn.utc.apply(this,arguments)};FCMoment.prototype.format=function(){if(arguments[0]){return formatDate(this,arguments[0])}if(this._ambigTime){return momentFormat(this,"YYYY-MM-DD")}if(this._ambigZone){return momentFormat(this,"YYYY-MM-DD[T]HH:mm:ss")}return momentFormat(this)};FCMoment.prototype.toISOString=function(){if(this._ambigTime){return momentFormat(this,"YYYY-MM-DD")}if(this._ambigZone){return momentFormat(this,"YYYY-MM-DD[T]HH:mm:ss")}return moment.fn.toISOString.apply(this,arguments)};FCMoment.prototype.isWithin=function(start,end){var a=commonlyAmbiguate([this,start,end]);return a[0]>=a[1]&&a[0]<a[2]};FCMoment.prototype.isSame=function(input,units){var a;if(units){a=commonlyAmbiguate([this,input],true);return moment.fn.isSame.call(a[0],a[1],units)}else{input=fc.moment.parseZone(input);return moment.fn.isSame.call(this,input)&&Boolean(this._ambigTime)===Boolean(input._ambigTime)&&Boolean(this._ambigZone)===Boolean(input._ambigZone)}};$.each(["isBefore","isAfter"],function(i,methodName){FCMoment.prototype[methodName]=function(input,units){var a=commonlyAmbiguate([this,input]);return moment.fn[methodName].call(a[0],a[1],units)}});function commonlyAmbiguate(inputs,preserveTime){var outputs=[];var anyAmbigTime=false;var anyAmbigZone=false;var i;for(i=0;i<inputs.length;i++){outputs.push(fc.moment.parseZone(inputs[i]));anyAmbigTime=anyAmbigTime||outputs[i]._ambigTime;anyAmbigZone=anyAmbigZone||outputs[i]._ambigZone}for(i=0;i<outputs.length;i++){if(anyAmbigTime&&!preserveTime){outputs[i].stripTime()}else if(anyAmbigZone){outputs[i].stripZone()}}return outputs}function momentFormat(mom,formatStr){return moment.fn.format.call(mom,formatStr)}function formatDate(date,formatStr){return formatDateWithChunks(date,getFormatStringChunks(formatStr))}function formatDateWithChunks(date,chunks){var s="";var i;for(i=0;i<chunks.length;i++){s+=formatDateWithChunk(date,chunks[i])}return s}var tokenOverrides={t:function(date){return momentFormat(date,"a").charAt(0)},T:function(date){return momentFormat(date,"A").charAt(0)}};function formatDateWithChunk(date,chunk){var token;var maybeStr;if(typeof chunk==="string"){return chunk}else if(token=chunk.token){if(tokenOverrides[token]){return tokenOverrides[token](date)}return momentFormat(date,token)}else if(chunk.maybe){maybeStr=formatDateWithChunks(date,chunk.maybe);if(maybeStr.match(/[1-9]/)){return maybeStr}}return""}function formatRange(date1,date2,formatStr,separator,isRTL){var localeData;date1=fc.moment.parseZone(date1);date2=fc.moment.parseZone(date2);localeData=(date1.localeData||date1.lang).call(date1);formatStr=localeData.longDateFormat(formatStr)||formatStr;separator=separator||" - ";return formatRangeWithChunks(date1,date2,getFormatStringChunks(formatStr),separator,isRTL)}fc.formatRange=formatRange;function formatRangeWithChunks(date1,date2,chunks,separator,isRTL){var chunkStr;var leftI;var leftStr="";var rightI;var rightStr="";var middleI;var middleStr1="";var middleStr2="";var middleStr="";for(leftI=0;leftI<chunks.length;leftI++){chunkStr=formatSimilarChunk(date1,date2,chunks[leftI]);if(chunkStr===false){break}leftStr+=chunkStr}for(rightI=chunks.length-1;rightI>leftI;rightI--){chunkStr=formatSimilarChunk(date1,date2,chunks[rightI]);if(chunkStr===false){break}rightStr=chunkStr+rightStr}for(middleI=leftI;middleI<=rightI;middleI++){middleStr1+=formatDateWithChunk(date1,chunks[middleI]);middleStr2+=formatDateWithChunk(date2,chunks[middleI])}if(middleStr1||middleStr2){if(isRTL){middleStr=middleStr2+separator+middleStr1}else{middleStr=middleStr1+separator+middleStr2}}return leftStr+middleStr+rightStr}var similarUnitMap={Y:"year",M:"month",D:"day",d:"day",A:"second",a:"second",T:"second",t:"second",H:"second",h:"second",m:"second",s:"second"};function formatSimilarChunk(date1,date2,chunk){var token;var unit;if(typeof chunk==="string"){return chunk}else if(token=chunk.token){unit=similarUnitMap[token.charAt(0)];if(unit&&date1.isSame(date2,unit)){return momentFormat(date1,token)}}return false}var formatStringChunkCache={};function getFormatStringChunks(formatStr){if(formatStr in formatStringChunkCache){return formatStringChunkCache[formatStr]}return formatStringChunkCache[formatStr]=chunkFormatString(formatStr)}function chunkFormatString(formatStr){var chunks=[];var chunker=/\[([^\]]*)\]|\(([^\)]*)\)|(LT|(\w)\4*o?)|([^\w\[\(]+)/g;var match;while(match=chunker.exec(formatStr)){if(match[1]){chunks.push(match[1])}else if(match[2]){chunks.push({maybe:chunkFormatString(match[2])})}else if(match[3]){chunks.push({token:match[3]})}else if(match[5]){chunks.push(match[5])}}return chunks}function Popover(options){this.options=options||{}}Popover.prototype={isHidden:true,options:null,el:null,documentMousedownProxy:null,margin:10,show:function(){if(this.isHidden){if(!this.el){this.render()}this.el.show();this.position();this.isHidden=false;this.trigger("show")}},hide:function(){if(!this.isHidden){this.el.hide();this.isHidden=true;this.trigger("hide")}},render:function(){var _this=this;var options=this.options;this.el=$('<div class="fc-popover"/>').addClass(options.className||"").css({top:0,left:0}).append(options.content).appendTo(options.parentEl);this.el.on("click",".fc-close",function(){_this.hide()});if(options.autoHide){$(document).on("mousedown",this.documentMousedownProxy=$.proxy(this,"documentMousedown"))}},documentMousedown:function(ev){if(this.el&&!$(ev.target).closest(this.el).length){this.hide()}},destroy:function(){this.hide();if(this.el){this.el.remove();this.el=null}$(document).off("mousedown",this.documentMousedownProxy)},position:function(){var options=this.options;var origin=this.el.offsetParent().offset();var width=this.el.outerWidth();var height=this.el.outerHeight();var windowEl=$(window);var viewportEl=getScrollParent(this.el);var viewportTop;var viewportLeft;var viewportOffset;var top;var left;top=options.top||0;if(options.left!==undefined){left=options.left}else if(options.right!==undefined){left=options.right-width}else{left=0}if(viewportEl.is(window)||viewportEl.is(document)){viewportEl=windowEl;viewportTop=0;viewportLeft=0}else{viewportOffset=viewportEl.offset();viewportTop=viewportOffset.top;viewportLeft=viewportOffset.left}viewportTop+=windowEl.scrollTop();viewportLeft+=windowEl.scrollLeft();if(options.viewportConstrain!==false){top=Math.min(top,viewportTop+viewportEl.outerHeight()-height-this.margin);top=Math.max(top,viewportTop+this.margin);left=Math.min(left,viewportLeft+viewportEl.outerWidth()-width-this.margin);left=Math.max(left,viewportLeft+this.margin)}this.el.css({top:top-origin.top,left:left-origin.left})},trigger:function(name){if(this.options[name]){this.options[name].apply(this,Array.prototype.slice.call(arguments,1))}}};function GridCoordMap(grid){this.grid=grid}GridCoordMap.prototype={grid:null,rows:null,cols:null,containerEl:null,minX:null,maxX:null,minY:null,maxY:null,build:function(){this.grid.buildCoords(this.rows=[],this.cols=[]);this.computeBounds()},getCell:function(x,y){var cell=null;var rows=this.rows;var cols=this.cols;var r=-1;var c=-1;var i;if(this.inBounds(x,y)){for(i=0;i<rows.length;i++){if(y>=rows[i][0]&&y<rows[i][1]){r=i;break}}for(i=0;i<cols.length;i++){if(x>=cols[i][0]&&x<cols[i][1]){c=i;break}}if(r>=0&&c>=0){cell={row:r,col:c};cell.grid=this.grid;cell.date=this.grid.getCellDate(cell)}}return cell},computeBounds:function(){var containerOffset;if(this.containerEl){containerOffset=this.containerEl.offset();this.minX=containerOffset.left;this.maxX=containerOffset.left+this.containerEl.outerWidth();this.minY=containerOffset.top;this.maxY=containerOffset.top+this.containerEl.outerHeight()}},inBounds:function(x,y){if(this.containerEl){return x>=this.minX&&x<this.maxX&&y>=this.minY&&y<this.maxY}return true}};function ComboCoordMap(coordMaps){this.coordMaps=coordMaps}ComboCoordMap.prototype={coordMaps:null,build:function(){var coordMaps=this.coordMaps;var i;for(i=0;i<coordMaps.length;i++){coordMaps[i].build()}},getCell:function(x,y){var coordMaps=this.coordMaps;var cell=null;var i;for(i=0;i<coordMaps.length&&!cell;i++){cell=coordMaps[i].getCell(x,y)}return cell}};function DragListener(coordMap,options){this.coordMap=coordMap;this.options=options||{}}DragListener.prototype={coordMap:null,options:null,isListening:false,isDragging:false,origCell:null,origDate:null,cell:null,date:null,mouseX0:null,mouseY0:null,mousemoveProxy:null,mouseupProxy:null,scrollEl:null,scrollBounds:null,scrollTopVel:null,scrollLeftVel:null,scrollIntervalId:null,scrollHandlerProxy:null,scrollSensitivity:30,scrollSpeed:200,scrollIntervalMs:50,mousedown:function(ev){if(isPrimaryMouseButton(ev)){ev.preventDefault();this.startListening(ev);if(!this.options.distance){this.startDrag(ev)}}},startListening:function(ev){var scrollParent;var cell;if(!this.isListening){if(ev&&this.options.scroll){scrollParent=getScrollParent($(ev.target));if(!scrollParent.is(window)&&!scrollParent.is(document)){this.scrollEl=scrollParent;this.scrollHandlerProxy=debounce($.proxy(this,"scrollHandler"),100);this.scrollEl.on("scroll",this.scrollHandlerProxy)}}this.computeCoords();if(ev){cell=this.getCell(ev);this.origCell=cell;this.origDate=cell?cell.date:null;this.mouseX0=ev.pageX;this.mouseY0=ev.pageY}$(document).on("mousemove",this.mousemoveProxy=$.proxy(this,"mousemove")).on("mouseup",this.mouseupProxy=$.proxy(this,"mouseup")).on("selectstart",this.preventDefault);this.isListening=true;this.trigger("listenStart",ev)}},computeCoords:function(){this.coordMap.build();this.computeScrollBounds()},mousemove:function(ev){var minDistance;var distanceSq;if(!this.isDragging){minDistance=this.options.distance||1;distanceSq=Math.pow(ev.pageX-this.mouseX0,2)+Math.pow(ev.pageY-this.mouseY0,2);if(distanceSq>=minDistance*minDistance){this.startDrag(ev)}}if(this.isDragging){this.drag(ev)}},startDrag:function(ev){var cell;if(!this.isListening){this.startListening()}if(!this.isDragging){this.isDragging=true;this.trigger("dragStart",ev);cell=this.getCell(ev);if(cell){this.cellOver(cell,true)}}},drag:function(ev){var cell;if(this.isDragging){cell=this.getCell(ev);if(!isCellsEqual(cell,this.cell)){if(this.cell){this.cellOut()}if(cell){this.cellOver(cell)}}this.dragScroll(ev)}},cellOver:function(cell){this.cell=cell;this.date=cell.date;this.trigger("cellOver",cell,cell.date)},cellOut:function(){if(this.cell){this.trigger("cellOut",this.cell);this.cell=null;this.date=null}},mouseup:function(ev){this.stopDrag(ev);this.stopListening(ev)},stopDrag:function(ev){if(this.isDragging){this.stopScrolling();this.trigger("dragStop",ev);this.isDragging=false}},stopListening:function(ev){if(this.isListening){if(this.scrollEl){this.scrollEl.off("scroll",this.scrollHandlerProxy);this.scrollHandlerProxy=null}$(document).off("mousemove",this.mousemoveProxy).off("mouseup",this.mouseupProxy).off("selectstart",this.preventDefault);this.mousemoveProxy=null;this.mouseupProxy=null;this.isListening=false;this.trigger("listenStop",ev);this.origCell=this.cell=null;this.origDate=this.date=null}},getCell:function(ev){return this.coordMap.getCell(ev.pageX,ev.pageY)},trigger:function(name){if(this.options[name]){this.options[name].apply(this,Array.prototype.slice.call(arguments,1))}},preventDefault:function(ev){ev.preventDefault()},computeScrollBounds:function(){var el=this.scrollEl;var offset;if(el){offset=el.offset();this.scrollBounds={top:offset.top,left:offset.left,bottom:offset.top+el.outerHeight(),right:offset.left+el.outerWidth()}}},dragScroll:function(ev){var sensitivity=this.scrollSensitivity;var bounds=this.scrollBounds;var topCloseness,bottomCloseness;var leftCloseness,rightCloseness;var topVel=0;var leftVel=0;if(bounds){topCloseness=(sensitivity-(ev.pageY-bounds.top))/sensitivity;bottomCloseness=(sensitivity-(bounds.bottom-ev.pageY))/sensitivity;leftCloseness=(sensitivity-(ev.pageX-bounds.left))/sensitivity;rightCloseness=(sensitivity-(bounds.right-ev.pageX))/sensitivity;if(topCloseness>=0&&topCloseness<=1){topVel=topCloseness*this.scrollSpeed*-1}else if(bottomCloseness>=0&&bottomCloseness<=1){topVel=bottomCloseness*this.scrollSpeed}if(leftCloseness>=0&&leftCloseness<=1){leftVel=leftCloseness*this.scrollSpeed*-1}else if(rightCloseness>=0&&rightCloseness<=1){leftVel=rightCloseness*this.scrollSpeed}}this.setScrollVel(topVel,leftVel)},setScrollVel:function(topVel,leftVel){this.scrollTopVel=topVel;this.scrollLeftVel=leftVel;this.constrainScrollVel();if((this.scrollTopVel||this.scrollLeftVel)&&!this.scrollIntervalId){this.scrollIntervalId=setInterval($.proxy(this,"scrollIntervalFunc"),this.scrollIntervalMs)}},constrainScrollVel:function(){var el=this.scrollEl;if(this.scrollTopVel<0){if(el.scrollTop()<=0){this.scrollTopVel=0}}else if(this.scrollTopVel>0){if(el.scrollTop()+el[0].clientHeight>=el[0].scrollHeight){this.scrollTopVel=0}}if(this.scrollLeftVel<0){if(el.scrollLeft()<=0){this.scrollLeftVel=0}}else if(this.scrollLeftVel>0){if(el.scrollLeft()+el[0].clientWidth>=el[0].scrollWidth){this.scrollLeftVel=0}}},scrollIntervalFunc:function(){var el=this.scrollEl;var frac=this.scrollIntervalMs/1e3;if(this.scrollTopVel){el.scrollTop(el.scrollTop()+this.scrollTopVel*frac)}if(this.scrollLeftVel){el.scrollLeft(el.scrollLeft()+this.scrollLeftVel*frac)}this.constrainScrollVel();if(!this.scrollTopVel&&!this.scrollLeftVel){this.stopScrolling()}},stopScrolling:function(){if(this.scrollIntervalId){clearInterval(this.scrollIntervalId);this.scrollIntervalId=null;this.computeCoords()}},scrollHandler:function(){if(!this.scrollIntervalId){this.computeCoords()}}};function isCellsEqual(cell1,cell2){if(!cell1&&!cell2){return true}if(cell1&&cell2){return cell1.grid===cell2.grid&&cell1.row===cell2.row&&cell1.col===cell2.col}return false}function MouseFollower(sourceEl,options){this.options=options=options||{};this.sourceEl=sourceEl;this.parentEl=options.parentEl?$(options.parentEl):sourceEl.parent()}MouseFollower.prototype={options:null,sourceEl:null,el:null,parentEl:null,top0:null,left0:null,mouseY0:null,mouseX0:null,topDelta:null,leftDelta:null,mousemoveProxy:null,isFollowing:false,isHidden:false,isAnimating:false,start:function(ev){if(!this.isFollowing){this.isFollowing=true;this.mouseY0=ev.pageY;this.mouseX0=ev.pageX;this.topDelta=0;this.leftDelta=0;if(!this.isHidden){this.updatePosition()}$(document).on("mousemove",this.mousemoveProxy=$.proxy(this,"mousemove"))}},stop:function(shouldRevert,callback){var _this=this;var revertDuration=this.options.revertDuration;function complete(){this.isAnimating=false;_this.destroyEl();this.top0=this.left0=null;if(callback){callback()}}if(this.isFollowing&&!this.isAnimating){this.isFollowing=false;$(document).off("mousemove",this.mousemoveProxy);if(shouldRevert&&revertDuration&&!this.isHidden){this.isAnimating=true;this.el.animate({top:this.top0,left:this.left0},{duration:revertDuration,complete:complete})}else{complete()}}},getEl:function(){var el=this.el;if(!el){this.sourceEl.width();el=this.el=this.sourceEl.clone().css({position:"absolute",visibility:"",display:this.isHidden?"none":"",margin:0,right:"auto",bottom:"auto",width:this.sourceEl.width(),height:this.sourceEl.height(),opacity:this.options.opacity||"",zIndex:this.options.zIndex}).appendTo(this.parentEl)}return el},destroyEl:function(){if(this.el){this.el.remove();this.el=null}},updatePosition:function(){var sourceOffset;var origin;this.getEl();if(this.top0===null){this.sourceEl.width();sourceOffset=this.sourceEl.offset();origin=this.el.offsetParent().offset();this.top0=sourceOffset.top-origin.top;this.left0=sourceOffset.left-origin.left}this.el.css({top:this.top0+this.topDelta,left:this.left0+this.leftDelta})},mousemove:function(ev){this.topDelta=ev.pageY-this.mouseY0;this.leftDelta=ev.pageX-this.mouseX0;if(!this.isHidden){this.updatePosition()}},hide:function(){if(!this.isHidden){this.isHidden=true;if(this.el){this.el.hide()}}},show:function(){if(this.isHidden){this.isHidden=false;this.updatePosition();this.getEl().show()}}};function RowRenderer(view){this.view=view}RowRenderer.prototype={view:null,cellHtml:"<td/>",rowHtml:function(rowType,row){var view=this.view;var renderCell=this.getHtmlRenderer("cell",rowType);var cellHtml="";var col;var date;row=row||0;for(col=0;col<view.colCnt;col++){date=view.cellToDate(row,col);cellHtml+=renderCell(row,col,date)}cellHtml=this.bookendCells(cellHtml,rowType,row);return"<tr>"+cellHtml+"</tr>"},bookendCells:function(cells,rowType,row){var view=this.view;var intro=this.getHtmlRenderer("intro",rowType)(row||0);var outro=this.getHtmlRenderer("outro",rowType)(row||0);var isRTL=view.opt("isRTL");var prependHtml=isRTL?outro:intro;var appendHtml=isRTL?intro:outro;if(typeof cells==="string"){return prependHtml+cells+appendHtml}else{return cells.prepend(prependHtml).append(appendHtml)}},getHtmlRenderer:function(rendererName,rowType){var view=this.view;var generalName;var specificName;var provider;var renderer;generalName=rendererName+"Html";if(rowType){specificName=rowType+capitaliseFirstLetter(rendererName)+"Html"}if(specificName&&(renderer=view[specificName])){provider=view}else if(specificName&&(renderer=this[specificName])){provider=this}else if(renderer=view[generalName]){provider=view}else if(renderer=this[generalName]){provider=this}if(typeof renderer==="function"){return function(row){return renderer.apply(provider,arguments)||""}}return function(){return renderer||""}}};function Grid(view){RowRenderer.call(this,view);this.coordMap=new GridCoordMap(this)}Grid.prototype=createObject(RowRenderer.prototype);$.extend(Grid.prototype,{el:null,coordMap:null,cellDuration:null,render:function(){this.bindHandlers()},destroy:function(){},buildCoords:function(rows,cols){},getCellDate:function(cell){},getCellDayEl:function(cell){},rangeToSegs:function(start,end){},bindHandlers:function(){var _this=this;this.el.on("mousedown",function(ev){if(!$(ev.target).is(".fc-event-container *, .fc-more")&&!$(ev.target).closest(".fc-popover").length){_this.dayMousedown(ev)}});this.bindSegHandlers()},dayMousedown:function(ev){var _this=this;var view=this.view;var isSelectable=view.opt("selectable");var dates=null;var start;var end;var dayEl;var dragListener=new DragListener(this.coordMap,{scroll:view.opt("dragScroll"),dragStart:function(){view.unselect()},cellOver:function(cell,date){if(dragListener.origDate){dayEl=_this.getCellDayEl(cell);dates=[date,dragListener.origDate].sort(dateCompare);start=dates[0];end=dates[1].clone().add(_this.cellDuration);if(isSelectable){_this.renderSelection(start,end)}}},cellOut:function(cell,date){dates=null;_this.destroySelection()},listenStop:function(ev){if(dates){if(dates[0].isSame(dates[1])){view.trigger("dayClick",dayEl[0],start,ev)}if(isSelectable){view.reportSelection(start,end,ev)}}}});dragListener.mousedown(ev)},renderDrag:function(start,end,seg){},destroyDrag:function(){},renderResize:function(start,end,seg){},destroyResize:function(){},renderRangeHelper:function(start,end,sourceSeg){var view=this.view;var fakeEvent;if(!end&&view.opt("forceEventDuration")){end=view.calendar.getDefaultEventEnd(!start.hasTime(),start)}fakeEvent=sourceSeg?createObject(sourceSeg.event):{};fakeEvent.start=start;fakeEvent.end=end;fakeEvent.allDay=!(start.hasTime()||end&&end.hasTime());fakeEvent.className=(fakeEvent.className||[]).concat("fc-helper");if(!sourceSeg){fakeEvent.editable=false}this.renderHelper(fakeEvent,sourceSeg)},renderHelper:function(event,sourceSeg){},destroyHelper:function(){},renderSelection:function(start,end){this.renderHighlight(start,end)},destroySelection:function(){this.destroyHighlight()},renderHighlight:function(start,end){},destroyHighlight:function(){},headHtml:function(){return""+'<div class="fc-row '+this.view.widgetHeaderClass+'">'+"<table>"+"<thead>"+this.rowHtml("head")+"</thead>"+"</table>"+"</div>"},headCellHtml:function(row,col,date){var view=this.view;var calendar=view.calendar;var colFormat=view.opt("columnFormat");return""+'<th class="fc-day-header '+view.widgetHeaderClass+" fc-"+dayIDs[date.day()]+'">'+htmlEscape(calendar.formatDate(date,colFormat))+"</th>"},bgCellHtml:function(row,col,date){var view=this.view;var classes=this.getDayClasses(date);classes.unshift("fc-day",view.widgetContentClass);return'<td class="'+classes.join(" ")+'" data-date="'+date.format()+'"></td>'},getDayClasses:function(date){var view=this.view;var today=view.calendar.getNow().stripTime();var classes=["fc-"+dayIDs[date.day()]];if(view.name==="month"&&date.month()!=view.intervalStart.month()){classes.push("fc-other-month")}if(date.isSame(today,"day")){classes.push("fc-today",view.highlightStateClass)}else if(date<today){classes.push("fc-past")}else{classes.push("fc-future")}return classes}});$.extend(Grid.prototype,{mousedOverSeg:null,isDraggingSeg:false,isResizingSeg:false,renderEvents:function(events){},getSegs:function(){},destroyEvents:function(){this.triggerSegMouseout()},renderSegs:function(segs,disableResizing){var view=this.view;var html="";var renderedSegs=[];var i;for(i=0;i<segs.length;i++){html+=this.renderSegHtml(segs[i],disableResizing)}$(html).each(function(i,node){var seg=segs[i];var el=view.resolveEventEl(seg.event,$(node));if(el){el.data("fc-seg",seg);seg.el=el;renderedSegs.push(seg)}});return renderedSegs},renderSegHtml:function(seg,disableResizing){},eventsToSegs:function(events,intervalStart,intervalEnd){var _this=this;return $.map(events,function(event){return _this.eventToSegs(event,intervalStart,intervalEnd)})},eventToSegs:function(event,intervalStart,intervalEnd){var eventStart=event.start.clone().stripZone();var eventEnd=this.view.calendar.getEventEnd(event).stripZone();var segs;var i,seg;if(intervalStart&&intervalEnd){seg=intersectionToSeg(eventStart,eventEnd,intervalStart,intervalEnd);segs=seg?[seg]:[]}else{segs=this.rangeToSegs(eventStart,eventEnd)}for(i=0;i<segs.length;i++){seg=segs[i];seg.event=event;seg.eventStartMS=+eventStart;seg.eventDurationMS=eventEnd-eventStart}return segs},bindSegHandlers:function(){var _this=this;var view=this.view;$.each({mouseenter:function(seg,ev){_this.triggerSegMouseover(seg,ev)},mouseleave:function(seg,ev){_this.triggerSegMouseout(seg,ev)},click:function(seg,ev){return view.trigger("eventClick",this,seg.event,ev)},mousedown:function(seg,ev){if($(ev.target).is(".fc-resizer")&&view.isEventResizable(seg.event)){_this.segResizeMousedown(seg,ev)}else if(view.isEventDraggable(seg.event)){_this.segDragMousedown(seg,ev)}}},function(name,func){_this.el.on(name,".fc-event-container > *",function(ev){var seg=$(this).data("fc-seg");if(seg&&!_this.isDraggingSeg&&!_this.isResizingSeg){return func.call(this,seg,ev)}})})},triggerSegMouseover:function(seg,ev){if(!this.mousedOverSeg){this.mousedOverSeg=seg;this.view.trigger("eventMouseover",seg.el[0],seg.event,ev)}},triggerSegMouseout:function(seg,ev){ev=ev||{};if(this.mousedOverSeg){seg=seg||this.mousedOverSeg;this.mousedOverSeg=null;this.view.trigger("eventMouseout",seg.el[0],seg.event,ev)}},segDragMousedown:function(seg,ev){var _this=this;var view=this.view;var el=seg.el;var event=seg.event;var newStart,newEnd;var mouseFollower=new MouseFollower(seg.el,{parentEl:view.el,opacity:view.opt("dragOpacity"),revertDuration:view.opt("dragRevertDuration"),zIndex:2});var dragListener=new DragListener(view.coordMap,{distance:5,scroll:view.opt("dragScroll"),listenStart:function(ev){mouseFollower.hide();mouseFollower.start(ev)},dragStart:function(ev){_this.triggerSegMouseout(seg,ev);_this.isDraggingSeg=true;view.hideEvent(event);view.trigger("eventDragStart",el[0],event,ev,{})},cellOver:function(cell,date){var origDate=seg.cellDate||dragListener.origDate;var res=_this.computeDraggedEventDates(seg,origDate,date);newStart=res.start;newEnd=res.end;if(view.renderDrag(newStart,newEnd,seg)){mouseFollower.hide()}else{mouseFollower.show()}},cellOut:function(){newStart=null;view.destroyDrag();mouseFollower.show()},dragStop:function(ev){var hasChanged=newStart&&!newStart.isSame(event.start);mouseFollower.stop(!hasChanged,function(){_this.isDraggingSeg=false;view.destroyDrag();view.showEvent(event);view.trigger("eventDragStop",el[0],event,ev,{});if(hasChanged){view.eventDrop(el[0],event,newStart,ev)}})},listenStop:function(){mouseFollower.stop()}});dragListener.mousedown(ev)},computeDraggedEventDates:function(seg,dragStartDate,dropDate){var view=this.view;var event=seg.event;var start=event.start;var end=view.calendar.getEventEnd(event);var delta;var newStart;var newEnd;if(dropDate.hasTime()===dragStartDate.hasTime()){delta=dayishDiff(dropDate,dragStartDate);newStart=start.clone().add(delta);if(event.end===null){newEnd=null}else{newEnd=end.clone().add(delta)}}else{newStart=dropDate;newEnd=null}return{start:newStart,end:newEnd}},segResizeMousedown:function(seg,ev){var _this=this;var view=this.view;var el=seg.el;var event=seg.event;var start=event.start;var end=view.calendar.getEventEnd(event);var newEnd=null;var dragListener;function destroy(){_this.destroyResize();view.showEvent(event)}dragListener=new DragListener(this.coordMap,{distance:5,scroll:view.opt("dragScroll"),dragStart:function(ev){_this.triggerSegMouseout(seg,ev);_this.isResizingSeg=true;view.trigger("eventResizeStart",el[0],event,ev,{})},cellOver:function(cell,date){if(date.isBefore(start)){date=start}newEnd=date.clone().add(_this.cellDuration);if(newEnd.isSame(end)){newEnd=null;destroy()}else{_this.renderResize(start,newEnd,seg);view.hideEvent(event)}},cellOut:function(){newEnd=null;destroy()},dragStop:function(ev){_this.isResizingSeg=false;destroy();view.trigger("eventResizeStop",el[0],event,ev,{});if(newEnd){view.eventResize(el[0],event,newEnd,ev)}}});dragListener.mousedown(ev)},getSegClasses:function(seg,isDraggable,isResizable){var event=seg.event;var classes=["fc-event",seg.isStart?"fc-start":"fc-not-start",seg.isEnd?"fc-end":"fc-not-end"].concat(event.className,event.source?event.source.className:[]);if(isDraggable){classes.push("fc-draggable")}if(isResizable){classes.push("fc-resizable")}return classes},getEventSkinCss:function(event){var view=this.view;var source=event.source||{};var eventColor=event.color;var sourceColor=source.color;var optionColor=view.opt("eventColor");var backgroundColor=event.backgroundColor||eventColor||source.backgroundColor||sourceColor||view.opt("eventBackgroundColor")||optionColor;var borderColor=event.borderColor||eventColor||source.borderColor||sourceColor||view.opt("eventBorderColor")||optionColor;var textColor=event.textColor||source.textColor||view.opt("eventTextColor");var statements=[];if(backgroundColor){statements.push("background-color:"+backgroundColor)}if(borderColor){statements.push("border-color:"+borderColor)}if(textColor){statements.push("color:"+textColor)}return statements.join(";")}});function compareSegs(seg1,seg2){return seg1.eventStartMS-seg2.eventStartMS||seg2.eventDurationMS-seg1.eventDurationMS||seg2.event.allDay-seg1.event.allDay||(seg1.event.title||"").localeCompare(seg2.event.title)}function DayGrid(view){Grid.call(this,view)}DayGrid.prototype=createObject(Grid.prototype);$.extend(DayGrid.prototype,{numbersVisible:false,cellDuration:moment.duration({days:1}),bottomCoordPadding:0,rowEls:null,dayEls:null,helperEls:null,highlightEls:null,render:function(isRigid){var view=this.view;var html="";var row;for(row=0;row<view.rowCnt;row++){html+=this.dayRowHtml(row,isRigid)}this.el.html(html);this.rowEls=this.el.find(".fc-row");this.dayEls=this.el.find(".fc-day");this.dayEls.each(function(i,node){var date=view.cellToDate(Math.floor(i/view.colCnt),i%view.colCnt);view.trigger("dayRender",null,date,$(node))});Grid.prototype.render.call(this)},destroy:function(){this.destroySegPopover()},dayRowHtml:function(row,isRigid){var view=this.view;var classes=["fc-row","fc-week",view.widgetContentClass];if(isRigid){classes.push("fc-rigid")}return""+'<div class="'+classes.join(" ")+'">'+'<div class="fc-bg">'+"<table>"+this.rowHtml("day",row)+"</table>"+"</div>"+'<div class="fc-content-skeleton">'+"<table>"+(this.numbersVisible?"<thead>"+this.rowHtml("number",row)+"</thead>":"")+"</table>"+"</div>"+"</div>"},dayCellHtml:function(row,col,date){return this.bgCellHtml(row,col,date)},buildCoords:function(rows,cols){var colCnt=this.view.colCnt;var e,n,p;this.dayEls.slice(0,colCnt).each(function(i,_e){e=$(_e);n=e.offset().left;if(i){p[1]=n}p=[n];cols[i]=p});p[1]=n+e.outerWidth();this.rowEls.each(function(i,_e){e=$(_e);n=e.offset().top;if(i){p[1]=n}p=[n];rows[i]=p});p[1]=n+e.outerHeight()+this.bottomCoordPadding},getCellDate:function(cell){return this.view.cellToDate(cell)},getCellDayEl:function(cell){return this.dayEls.eq(cell.row*this.view.colCnt+cell.col)},rangeToSegs:function(start,end){return this.view.rangeToSegments(start,end)},renderDrag:function(start,end,seg){var opacity;this.renderHighlight(start,end||this.view.calendar.getDefaultEventEnd(true,start));if(seg&&!seg.el.closest(this.el).length){this.renderRangeHelper(start,end,seg);opacity=this.view.opt("dragOpacity");if(opacity!==undefined){this.helperEls.css("opacity",opacity)}return true}},destroyDrag:function(){this.destroyHighlight();this.destroyHelper()},renderResize:function(start,end,seg){this.renderHighlight(start,end);this.renderRangeHelper(start,end,seg)},destroyResize:function(){this.destroyHighlight();this.destroyHelper()},renderHelper:function(event,sourceSeg){var helperNodes=[];var rowStructs=this.renderEventRows([event]);this.rowEls.each(function(row,rowNode){var rowEl=$(rowNode);var skeletonEl=$('<div class="fc-helper-skeleton"><table/></div>');var skeletonTop;if(sourceSeg&&sourceSeg.row===row){skeletonTop=sourceSeg.el.position().top}else{skeletonTop=rowEl.find(".fc-content-skeleton tbody").position().top}skeletonEl.css("top",skeletonTop).find("table").append(rowStructs[row].tbodyEl);rowEl.append(skeletonEl);helperNodes.push(skeletonEl[0])});this.helperEls=$(helperNodes)},destroyHelper:function(){if(this.helperEls){this.helperEls.remove();this.helperEls=null}},renderHighlight:function(start,end){var segs=this.rangeToSegs(start,end);var highlightNodes=[];var i,seg;var el;for(i=0;i<segs.length;i++){seg=segs[i];el=$(this.highlightSkeletonHtml(seg.leftCol,seg.rightCol+1));el.appendTo(this.rowEls[seg.row]);
highlightNodes.push(el[0])}this.highlightEls=$(highlightNodes)},destroyHighlight:function(){if(this.highlightEls){this.highlightEls.remove();this.highlightEls=null}},highlightSkeletonHtml:function(startCol,endCol){var colCnt=this.view.colCnt;var cellHtml="";if(startCol>0){cellHtml+='<td colspan="'+startCol+'"/>'}if(endCol>startCol){cellHtml+='<td colspan="'+(endCol-startCol)+'" class="fc-highlight" />'}if(colCnt>endCol){cellHtml+='<td colspan="'+(colCnt-endCol)+'"/>'}cellHtml=this.bookendCells(cellHtml,"highlight");return""+'<div class="fc-highlight-skeleton">'+"<table>"+"<tr>"+cellHtml+"</tr>"+"</table>"+"</div>"}});$.extend(DayGrid.prototype,{segs:null,rowStructs:null,renderEvents:function(events){var rowStructs=this.rowStructs=this.renderEventRows(events);var segs=[];this.rowEls.each(function(i,rowNode){$(rowNode).find(".fc-content-skeleton > table").append(rowStructs[i].tbodyEl);segs.push.apply(segs,rowStructs[i].segs)});this.segs=segs},getSegs:function(){return(this.segs||[]).concat(this.popoverSegs||[])},destroyEvents:function(){var rowStructs;var rowStruct;Grid.prototype.destroyEvents.call(this);rowStructs=this.rowStructs||[];while(rowStruct=rowStructs.pop()){rowStruct.tbodyEl.remove()}this.segs=null;this.destroySegPopover()},renderEventRows:function(events){var segs=this.eventsToSegs(events);var rowStructs=[];var segRows;var row;segs=this.renderSegs(segs);segRows=this.groupSegRows(segs);for(row=0;row<segRows.length;row++){rowStructs.push(this.renderEventRow(row,segRows[row]))}return rowStructs},renderSegHtml:function(seg,disableResizing){var view=this.view;var isRTL=view.opt("isRTL");var event=seg.event;var isDraggable=view.isEventDraggable(event);var isResizable=!disableResizing&&event.allDay&&seg.isEnd&&view.isEventResizable(event);var classes=this.getSegClasses(seg,isDraggable,isResizable);var skinCss=this.getEventSkinCss(event);var timeHtml="";var titleHtml;classes.unshift("fc-day-grid-event");if(!event.allDay&&seg.isStart){timeHtml='<span class="fc-time">'+htmlEscape(view.getEventTimeText(event))+"</span>"}titleHtml='<span class="fc-title">'+(htmlEscape(event.title||"")||"&nbsp;")+"</span>";return'<a class="'+classes.join(" ")+'"'+(event.url?' href="'+htmlEscape(event.url)+'"':"")+(skinCss?' style="'+skinCss+'"':"")+">"+'<div class="fc-content">'+(isRTL?titleHtml+" "+timeHtml:timeHtml+" "+titleHtml)+"</div>"+(isResizable?'<div class="fc-resizer"/>':"")+"</a>"},renderEventRow:function(row,rowSegs){var view=this.view;var colCnt=view.colCnt;var segLevels=this.buildSegLevels(rowSegs);var levelCnt=Math.max(1,segLevels.length);var tbody=$("<tbody/>");var segMatrix=[];var cellMatrix=[];var loneCellMatrix=[];var i,levelSegs;var col;var tr;var j,seg;var td;function emptyCellsUntil(endCol){while(col<endCol){td=(loneCellMatrix[i-1]||[])[col];if(td){td.attr("rowspan",parseInt(td.attr("rowspan")||1,10)+1)}else{td=$("<td/>");tr.append(td)}cellMatrix[i][col]=td;loneCellMatrix[i][col]=td;col++}}for(i=0;i<levelCnt;i++){levelSegs=segLevels[i];col=0;tr=$("<tr/>");segMatrix.push([]);cellMatrix.push([]);loneCellMatrix.push([]);if(levelSegs){for(j=0;j<levelSegs.length;j++){seg=levelSegs[j];emptyCellsUntil(seg.leftCol);td=$('<td class="fc-event-container"/>').append(seg.el);if(seg.leftCol!=seg.rightCol){td.attr("colspan",seg.rightCol-seg.leftCol+1)}else{loneCellMatrix[i][col]=td}while(col<=seg.rightCol){cellMatrix[i][col]=td;segMatrix[i][col]=seg;col++}tr.append(td)}}emptyCellsUntil(colCnt);this.bookendCells(tr,"eventSkeleton");tbody.append(tr)}return{row:row,tbodyEl:tbody,cellMatrix:cellMatrix,segMatrix:segMatrix,segLevels:segLevels,segs:rowSegs}},buildSegLevels:function(segs){var levels=[];var i,seg;var j;segs.sort(compareSegs);for(i=0;i<segs.length;i++){seg=segs[i];for(j=0;j<levels.length;j++){if(!isDaySegCollision(seg,levels[j])){break}}seg.level=j;(levels[j]||(levels[j]=[])).push(seg)}for(j=0;j<levels.length;j++){levels[j].sort(compareDaySegCols)}return levels},groupSegRows:function(segs){var view=this.view;var segRows=[];var i;for(i=0;i<view.rowCnt;i++){segRows.push([])}for(i=0;i<segs.length;i++){segRows[segs[i].row].push(segs[i])}return segRows}});function isDaySegCollision(seg,otherSegs){var i,otherSeg;for(i=0;i<otherSegs.length;i++){otherSeg=otherSegs[i];if(otherSeg.leftCol<=seg.rightCol&&otherSeg.rightCol>=seg.leftCol){return true}}return false}function compareDaySegCols(a,b){return a.leftCol-b.leftCol}$.extend(DayGrid.prototype,{segPopover:null,popoverSegs:null,destroySegPopover:function(){if(this.segPopover){this.segPopover.hide()}},limitRows:function(levelLimit){var rowStructs=this.rowStructs||[];var row;var rowLevelLimit;for(row=0;row<rowStructs.length;row++){this.unlimitRow(row);if(!levelLimit){rowLevelLimit=false}else if(typeof levelLimit==="number"){rowLevelLimit=levelLimit}else{rowLevelLimit=this.computeRowLevelLimit(row)}if(rowLevelLimit!==false){this.limitRow(row,rowLevelLimit)}}},computeRowLevelLimit:function(row){var rowEl=this.rowEls.eq(row);var rowHeight=rowEl.height();var trEls=this.rowStructs[row].tbodyEl.children();var i,trEl;for(i=0;i<trEls.length;i++){trEl=trEls.eq(i).removeClass("fc-limited");if(trEl.position().top+trEl.outerHeight()>rowHeight){return i}}return false},limitRow:function(row,levelLimit){var _this=this;var view=this.view;var rowStruct=this.rowStructs[row];var moreNodes=[];var col=0;var cell;var levelSegs;var cellMatrix;var limitedNodes;var i,seg;var segsBelow;var totalSegsBelow;var colSegsBelow;var td,rowspan;var segMoreNodes;var j;var moreTd,moreWrap,moreLink;function emptyCellsUntil(endCol){while(col<endCol){cell={row:row,col:col};segsBelow=_this.getCellSegs(cell,levelLimit);if(segsBelow.length){td=cellMatrix[levelLimit-1][col];moreLink=_this.renderMoreLink(cell,segsBelow);moreWrap=$("<div/>").append(moreLink);td.append(moreWrap);moreNodes.push(moreWrap[0])}col++}}if(levelLimit&&levelLimit<rowStruct.segLevels.length){levelSegs=rowStruct.segLevels[levelLimit-1];cellMatrix=rowStruct.cellMatrix;limitedNodes=rowStruct.tbodyEl.children().slice(levelLimit).addClass("fc-limited").get();for(i=0;i<levelSegs.length;i++){seg=levelSegs[i];emptyCellsUntil(seg.leftCol);colSegsBelow=[];totalSegsBelow=0;while(col<=seg.rightCol){cell={row:row,col:col};segsBelow=this.getCellSegs(cell,levelLimit);colSegsBelow.push(segsBelow);totalSegsBelow+=segsBelow.length;col++}if(totalSegsBelow){td=cellMatrix[levelLimit-1][seg.leftCol];rowspan=td.attr("rowspan")||1;segMoreNodes=[];for(j=0;j<colSegsBelow.length;j++){moreTd=$('<td class="fc-more-cell"/>').attr("rowspan",rowspan);segsBelow=colSegsBelow[j];cell={row:row,col:seg.leftCol+j};moreLink=this.renderMoreLink(cell,[seg].concat(segsBelow));moreWrap=$("<div/>").append(moreLink);moreTd.append(moreWrap);segMoreNodes.push(moreTd[0]);moreNodes.push(moreTd[0])}td.addClass("fc-limited").after($(segMoreNodes));limitedNodes.push(td[0])}}emptyCellsUntil(view.colCnt);rowStruct.moreEls=$(moreNodes);rowStruct.limitedEls=$(limitedNodes)}},unlimitRow:function(row){var rowStruct=this.rowStructs[row];if(rowStruct.moreEls){rowStruct.moreEls.remove();rowStruct.moreEls=null}if(rowStruct.limitedEls){rowStruct.limitedEls.removeClass("fc-limited");rowStruct.limitedEls=null}},renderMoreLink:function(cell,hiddenSegs){var _this=this;var view=this.view;return $('<a class="fc-more"/>').text(this.getMoreLinkText(hiddenSegs.length)).on("click",function(ev){var clickOption=view.opt("eventLimitClick");var date=view.cellToDate(cell);var moreEl=$(this);var dayEl=_this.getCellDayEl(cell);var allSegs=_this.getCellSegs(cell);var reslicedAllSegs=_this.resliceDaySegs(allSegs,date);var reslicedHiddenSegs=_this.resliceDaySegs(hiddenSegs,date);if(typeof clickOption==="function"){clickOption=view.trigger("eventLimitClick",null,{date:date,dayEl:dayEl,moreEl:moreEl,segs:reslicedAllSegs,hiddenSegs:reslicedHiddenSegs},ev)}if(clickOption==="popover"){_this.showSegPopover(date,cell,moreEl,reslicedAllSegs)}else if(typeof clickOption==="string"){view.calendar.zoomTo(date,clickOption)}})},showSegPopover:function(date,cell,moreLink,segs){var _this=this;var view=this.view;var moreWrap=moreLink.parent();var topEl;var options;if(view.rowCnt==1){topEl=this.view.el}else{topEl=this.rowEls.eq(cell.row)}options={className:"fc-more-popover",content:this.renderSegPopoverContent(date,segs),parentEl:this.el,top:topEl.offset().top,autoHide:true,viewportConstrain:view.opt("popoverViewportConstrain"),hide:function(){_this.segPopover.destroy();_this.segPopover=null;_this.popoverSegs=null}};if(view.opt("isRTL")){options.right=moreWrap.offset().left+moreWrap.outerWidth()+1}else{options.left=moreWrap.offset().left-1}this.segPopover=new Popover(options);this.segPopover.show()},renderSegPopoverContent:function(date,segs){var view=this.view;var isTheme=view.opt("theme");var title=date.format(view.opt("dayPopoverFormat"));var content=$('<div class="fc-header '+view.widgetHeaderClass+'">'+'<span class="fc-close '+(isTheme?"ui-icon ui-icon-closethick":"fc-icon fc-icon-x")+'"></span>'+'<span class="fc-title">'+htmlEscape(title)+"</span>"+'<div class="fc-clear"/>'+"</div>"+'<div class="fc-body '+view.widgetContentClass+'">'+'<div class="fc-event-container"></div>'+"</div>");var segContainer=content.find(".fc-event-container");var i;segs=this.renderSegs(segs,true);this.popoverSegs=segs;for(i=0;i<segs.length;i++){segs[i].cellDate=date;segContainer.append(segs[i].el)}return content},resliceDaySegs:function(segs,dayDate){var events=$.map(segs,function(seg){return seg.event});var dayStart=dayDate.clone().stripTime();var dayEnd=dayStart.clone().add(1,"days");return this.eventsToSegs(events,dayStart,dayEnd)},getMoreLinkText:function(num){var view=this.view;var opt=view.opt("eventLimitText");if(typeof opt==="function"){return opt(num)}else{return"+"+num+" "+opt}},getCellSegs:function(cell,startLevel){var segMatrix=this.rowStructs[cell.row].segMatrix;var level=startLevel||0;var segs=[];var seg;while(level<segMatrix.length){seg=segMatrix[level][cell.col];if(seg){segs.push(seg)}level++}return segs}});function TimeGrid(view){Grid.call(this,view)}TimeGrid.prototype=createObject(Grid.prototype);$.extend(TimeGrid.prototype,{slotDuration:null,snapDuration:null,minTime:null,maxTime:null,dayEls:null,slatEls:null,slatTops:null,highlightEl:null,helperEl:null,render:function(){this.processOptions();this.el.html(this.renderHtml());this.dayEls=this.el.find(".fc-day");this.slatEls=this.el.find(".fc-slats tr");this.computeSlatTops();Grid.prototype.render.call(this)},renderHtml:function(){return""+'<div class="fc-bg">'+"<table>"+this.rowHtml("slotBg")+"</table>"+"</div>"+'<div class="fc-slats">'+"<table>"+this.slatRowHtml()+"</table>"+"</div>"},slotBgCellHtml:function(row,col,date){return this.bgCellHtml(row,col,date)},slatRowHtml:function(){var view=this.view;var calendar=view.calendar;var isRTL=view.opt("isRTL");var html="";var slotNormal=this.slotDuration.asMinutes()%15===0;var slotTime=moment.duration(+this.minTime);var slotDate;var minutes;var axisHtml;while(slotTime<this.maxTime){slotDate=view.start.clone().time(slotTime);minutes=slotDate.minutes();axisHtml='<td class="fc-axis fc-time '+view.widgetContentClass+'" '+view.axisStyleAttr()+">"+(!slotNormal||!minutes?"<span>"+htmlEscape(calendar.formatDate(slotDate,view.opt("axisFormat")))+"</span>":"")+"</td>";html+="<tr "+(!minutes?"":'class="fc-minor"')+">"+(!isRTL?axisHtml:"")+'<td class="'+view.widgetContentClass+'"/>'+(isRTL?axisHtml:"")+"</tr>";slotTime.add(this.slotDuration)}return html},processOptions:function(){var view=this.view;var slotDuration=view.opt("slotDuration");var snapDuration=view.opt("snapDuration");slotDuration=moment.duration(slotDuration);snapDuration=snapDuration?moment.duration(snapDuration):slotDuration;this.slotDuration=slotDuration;this.snapDuration=snapDuration;this.cellDuration=snapDuration;this.minTime=moment.duration(view.opt("minTime"));this.maxTime=moment.duration(view.opt("maxTime"))},rangeToSegs:function(rangeStart,rangeEnd){var view=this.view;var segs=[];var seg;var col;var cellDate;var colStart,colEnd;rangeStart=rangeStart.clone().stripZone();rangeEnd=rangeEnd.clone().stripZone();for(col=0;col<view.colCnt;col++){cellDate=view.cellToDate(0,col);colStart=cellDate.clone().time(this.minTime);colEnd=cellDate.clone().time(this.maxTime);seg=intersectionToSeg(rangeStart,rangeEnd,colStart,colEnd);if(seg){seg.col=col;segs.push(seg)}}return segs},resize:function(){this.computeSlatTops();this.updateSegVerticals()},buildCoords:function(rows,cols){var colCnt=this.view.colCnt;var originTop=this.el.offset().top;var snapTime=moment.duration(+this.minTime);var p=null;var e,n;this.dayEls.slice(0,colCnt).each(function(i,_e){e=$(_e);n=e.offset().left;if(p){p[1]=n}p=[n];cols[i]=p});p[1]=n+e.outerWidth();p=null;while(snapTime<this.maxTime){n=originTop+this.computeTimeTop(snapTime);if(p){p[1]=n}p=[n];rows.push(p);snapTime.add(this.snapDuration)}p[1]=originTop+this.computeTimeTop(snapTime)},getCellDate:function(cell){var view=this.view;var calendar=view.calendar;return calendar.rezoneDate(view.cellToDate(0,cell.col).time(this.minTime+this.snapDuration*cell.row))},getCellDayEl:function(cell){return this.dayEls.eq(cell.col)},computeDateTop:function(date,startOfDayDate){return this.computeTimeTop(moment.duration(date.clone().stripZone()-startOfDayDate.clone().stripTime()))},computeTimeTop:function(time){var slatCoverage=(time-this.minTime)/this.slotDuration;var slatIndex;var slatRemainder;var slatTop;var slatBottom;slatCoverage=Math.max(0,slatCoverage);slatCoverage=Math.min(this.slatEls.length,slatCoverage);slatIndex=Math.floor(slatCoverage);slatRemainder=slatCoverage-slatIndex;slatTop=this.slatTops[slatIndex];if(slatRemainder){slatBottom=this.slatTops[slatIndex+1];return slatTop+(slatBottom-slatTop)*slatRemainder}else{return slatTop}},computeSlatTops:function(){var tops=[];var top;this.slatEls.each(function(i,node){top=$(node).position().top;tops.push(top)});tops.push(top+this.slatEls.last().outerHeight());this.slatTops=tops},renderDrag:function(start,end,seg){var opacity;if(seg){this.renderRangeHelper(start,end,seg);opacity=this.view.opt("dragOpacity");if(opacity!==undefined){this.helperEl.css("opacity",opacity)}return true}else{this.renderHighlight(start,end||this.view.calendar.getDefaultEventEnd(false,start))}},destroyDrag:function(){this.destroyHelper();this.destroyHighlight()},renderResize:function(start,end,seg){this.renderRangeHelper(start,end,seg)},destroyResize:function(){this.destroyHelper()},renderHelper:function(event,sourceSeg){var res=this.renderEventTable([event]);var tableEl=res.tableEl;var segs=res.segs;var i,seg;var sourceEl;for(i=0;i<segs.length;i++){seg=segs[i];if(sourceSeg&&sourceSeg.col===seg.col){sourceEl=sourceSeg.el;seg.el.css({left:sourceEl.css("left"),right:sourceEl.css("right"),"margin-left":sourceEl.css("margin-left"),"margin-right":sourceEl.css("margin-right")})}}this.helperEl=$('<div class="fc-helper-skeleton"/>').append(tableEl).appendTo(this.el)},destroyHelper:function(){if(this.helperEl){this.helperEl.remove();this.helperEl=null}},renderSelection:function(start,end){if(this.view.opt("selectHelper")){this.renderRangeHelper(start,end)}else{this.renderHighlight(start,end)}},destroySelection:function(){this.destroyHelper();this.destroyHighlight()},renderHighlight:function(start,end){this.highlightEl=$(this.highlightSkeletonHtml(start,end)).appendTo(this.el)},destroyHighlight:function(){if(this.highlightEl){this.highlightEl.remove();this.highlightEl=null}},highlightSkeletonHtml:function(start,end){var view=this.view;var segs=this.rangeToSegs(start,end);var cellHtml="";var col=0;var i,seg;var dayDate;var top,bottom;for(i=0;i<segs.length;i++){seg=segs[i];if(col<seg.col){cellHtml+='<td colspan="'+(seg.col-col)+'"/>';col=seg.col}dayDate=view.cellToDate(0,col);top=this.computeDateTop(seg.start,dayDate);bottom=this.computeDateTop(seg.end,dayDate);cellHtml+="<td>"+'<div class="fc-highlight-container">'+'<div class="fc-highlight" style="top:'+top+"px;bottom:-"+bottom+'px"/>'+"</div>"+"</td>";col++}if(col<view.colCnt){cellHtml+='<td colspan="'+(view.colCnt-col)+'"/>'}cellHtml=this.bookendCells(cellHtml,"highlight");return""+'<div class="fc-highlight-skeleton">'+"<table>"+"<tr>"+cellHtml+"</tr>"+"</table>"+"</div>"}});$.extend(TimeGrid.prototype,{segs:null,eventSkeletonEl:null,renderEvents:function(events){var res=this.renderEventTable(events);this.eventSkeletonEl=$('<div class="fc-content-skeleton"/>').append(res.tableEl);this.el.append(this.eventSkeletonEl);this.segs=res.segs},getSegs:function(){return this.segs||[]},destroyEvents:function(){Grid.prototype.destroyEvents.call(this);if(this.eventSkeletonEl){this.eventSkeletonEl.remove();this.eventSkeletonEl=null}this.segs=null},renderEventTable:function(events){var tableEl=$("<table><tr/></table>");var trEl=tableEl.find("tr");var segs=this.eventsToSegs(events);var segCols;var i,seg;var col,colSegs;var containerEl;segs=this.renderSegs(segs);segCols=this.groupSegCols(segs);this.computeSegVerticals(segs);for(col=0;col<segCols.length;col++){colSegs=segCols[col];placeSlotSegs(colSegs);containerEl=$('<div class="fc-event-container"/>');for(i=0;i<colSegs.length;i++){seg=colSegs[i];seg.el.css(this.generateSegPositionCss(seg));if(seg.bottom-seg.top<30){seg.el.addClass("fc-short")}containerEl.append(seg.el)}trEl.append($("<td/>").append(containerEl))}this.bookendCells(trEl,"eventSkeleton");return{tableEl:tableEl,segs:segs}},updateSegVerticals:function(){var segs=this.segs;var i;if(segs){this.computeSegVerticals(segs);for(i=0;i<segs.length;i++){segs[i].el.css(this.generateSegVerticalCss(segs[i]))}}},computeSegVerticals:function(segs){var i,seg;for(i=0;i<segs.length;i++){seg=segs[i];seg.top=this.computeDateTop(seg.start,seg.start);seg.bottom=this.computeDateTop(seg.end,seg.start)}},renderSegHtml:function(seg,disableResizing){var view=this.view;var event=seg.event;var isDraggable=view.isEventDraggable(event);var isResizable=!disableResizing&&seg.isEnd&&view.isEventResizable(event);var classes=this.getSegClasses(seg,isDraggable,isResizable);var skinCss=this.getEventSkinCss(event);var timeText;var fullTimeText;var startTimeText;classes.unshift("fc-time-grid-event");if(view.isMultiDayEvent(event)){if(seg.isStart||seg.isEnd){timeText=view.getEventTimeText(seg.start,seg.end);fullTimeText=view.getEventTimeText(seg.start,seg.end,"LT");startTimeText=view.getEventTimeText(seg.start,null)}}else{timeText=view.getEventTimeText(event);fullTimeText=view.getEventTimeText(event,"LT");startTimeText=view.getEventTimeText(event.start,null)}return'<a class="'+classes.join(" ")+'"'+(event.url?' href="'+htmlEscape(event.url)+'"':"")+(skinCss?' style="'+skinCss+'"':"")+">"+'<div class="fc-content">'+(timeText?'<div class="fc-time"'+' data-start="'+htmlEscape(startTimeText)+'"'+' data-full="'+htmlEscape(fullTimeText)+'"'+">"+"<span>"+htmlEscape(timeText)+"</span>"+"</div>":"")+(event.title?'<div class="fc-title">'+htmlEscape(event.title)+"</div>":"")+"</div>"+'<div class="fc-bg"/>'+(isResizable?'<div class="fc-resizer"/>':"")+"</a>"},generateSegPositionCss:function(seg){var view=this.view;var isRTL=view.opt("isRTL");var shouldOverlap=view.opt("slotEventOverlap");var backwardCoord=seg.backwardCoord;var forwardCoord=seg.forwardCoord;var props=this.generateSegVerticalCss(seg);var left;var right;if(shouldOverlap){forwardCoord=Math.min(1,backwardCoord+(forwardCoord-backwardCoord)*2)}if(isRTL){left=1-forwardCoord;right=backwardCoord}else{left=backwardCoord;right=1-forwardCoord}props.zIndex=seg.level+1;props.left=left*100+"%";props.right=right*100+"%";if(shouldOverlap&&seg.forwardPressure){props[isRTL?"marginLeft":"marginRight"]=10*2}return props},generateSegVerticalCss:function(seg){return{top:seg.top,bottom:-seg.bottom}},groupSegCols:function(segs){var view=this.view;var segCols=[];var i;for(i=0;i<view.colCnt;i++){segCols.push([])}for(i=0;i<segs.length;i++){segCols[segs[i].col].push(segs[i])}return segCols}});function placeSlotSegs(segs){var levels;var level0;var i;segs.sort(compareSegs);levels=buildSlotSegLevels(segs);computeForwardSlotSegs(levels);if(level0=levels[0]){for(i=0;i<level0.length;i++){computeSlotSegPressures(level0[i])}for(i=0;i<level0.length;i++){computeSlotSegCoords(level0[i],0,0)}}}function buildSlotSegLevels(segs){var levels=[];var i,seg;var j;for(i=0;i<segs.length;i++){seg=segs[i];for(j=0;j<levels.length;j++){if(!computeSlotSegCollisions(seg,levels[j]).length){break}}seg.level=j;(levels[j]||(levels[j]=[])).push(seg)}return levels}function computeForwardSlotSegs(levels){var i,level;var j,seg;var k;for(i=0;i<levels.length;i++){level=levels[i];for(j=0;j<level.length;j++){seg=level[j];seg.forwardSegs=[];for(k=i+1;k<levels.length;k++){computeSlotSegCollisions(seg,levels[k],seg.forwardSegs)}}}}function computeSlotSegPressures(seg){var forwardSegs=seg.forwardSegs;var forwardPressure=0;var i,forwardSeg;if(seg.forwardPressure===undefined){for(i=0;i<forwardSegs.length;i++){forwardSeg=forwardSegs[i];computeSlotSegPressures(forwardSeg);forwardPressure=Math.max(forwardPressure,1+forwardSeg.forwardPressure)}seg.forwardPressure=forwardPressure}}function computeSlotSegCoords(seg,seriesBackwardPressure,seriesBackwardCoord){var forwardSegs=seg.forwardSegs;var i;if(seg.forwardCoord===undefined){if(!forwardSegs.length){seg.forwardCoord=1}else{forwardSegs.sort(compareForwardSlotSegs);computeSlotSegCoords(forwardSegs[0],seriesBackwardPressure+1,seriesBackwardCoord);seg.forwardCoord=forwardSegs[0].backwardCoord}seg.backwardCoord=seg.forwardCoord-(seg.forwardCoord-seriesBackwardCoord)/(seriesBackwardPressure+1);for(i=0;i<forwardSegs.length;i++){computeSlotSegCoords(forwardSegs[i],0,seg.forwardCoord)}}}function computeSlotSegCollisions(seg,otherSegs,results){results=results||[];for(var i=0;i<otherSegs.length;i++){if(isSlotSegCollision(seg,otherSegs[i])){results.push(otherSegs[i])}}return results}function isSlotSegCollision(seg1,seg2){return seg1.bottom>seg2.top&&seg1.top<seg2.bottom}function compareForwardSlotSegs(seg1,seg2){return seg2.forwardPressure-seg1.forwardPressure||(seg1.backwardCoord||0)-(seg2.backwardCoord||0)||compareSegs(seg1,seg2)}View.prototype={calendar:null,coordMap:null,el:null,start:null,end:null,intervalStart:null,intervalEnd:null,rowCnt:null,colCnt:null,isSelected:false,scrollerEl:null,scrollTop:null,widgetHeaderClass:null,widgetContentClass:null,highlightStateClass:null,documentMousedownProxy:null,documentDragStartProxy:null,init:function(){var tm=this.opt("theme")?"ui":"fc";this.widgetHeaderClass=tm+"-widget-header";this.widgetContentClass=tm+"-widget-content";this.highlightStateClass=tm+"-state-highlight";this.documentMousedownProxy=$.proxy(this,"documentMousedown");this.documentDragStartProxy=$.proxy(this,"documentDragStart")},render:function(){this.updateSize();this.trigger("viewRender",this,this,this.el);$(document).on("mousedown",this.documentMousedownProxy).on("dragstart",this.documentDragStartProxy)},destroy:function(){this.unselect();this.trigger("viewDestroy",this,this,this.el);this.destroyEvents();this.el.empty();$(document).off("mousedown",this.documentMousedownProxy).off("dragstart",this.documentDragStartProxy)},incrementDate:function(date,delta){},updateSize:function(isResize){if(isResize){this.recordScroll()}this.updateHeight();this.updateWidth()},updateWidth:function(){},updateHeight:function(){var calendar=this.calendar;this.setHeight(calendar.getSuggestedViewHeight(),calendar.isHeightAuto())},setHeight:function(height,isAuto){},computeScrollerHeight:function(totalHeight){var both=this.el.add(this.scrollerEl);var otherHeight;both.css({position:"relative",left:-1});otherHeight=this.el.outerHeight()-this.scrollerEl.height();both.css({position:"",left:""});return totalHeight-otherHeight},recordScroll:function(){if(this.scrollerEl){this.scrollTop=this.scrollerEl.scrollTop()}},restoreScroll:function(){if(this.scrollTop!==null){this.scrollerEl.scrollTop(this.scrollTop)}},renderEvents:function(events){this.segEach(function(seg){this.trigger("eventAfterRender",seg.event,seg.event,seg.el)});this.trigger("eventAfterAllRender")},destroyEvents:function(){this.segEach(function(seg){this.trigger("eventDestroy",seg.event,seg.event,seg.el)})},resolveEventEl:function(event,el){var custom=this.trigger("eventRender",event,event,el);if(custom===false){el=null}else if(custom&&custom!==true){el=$(custom)}return el},showEvent:function(event){this.segEach(function(seg){seg.el.css("visibility","")},event)},hideEvent:function(event){this.segEach(function(seg){seg.el.css("visibility","hidden")},event)},segEach:function(func,event){var segs=this.getSegs();var i;for(i=0;i<segs.length;i++){if(!event||segs[i].event._id===event._id){func.call(this,segs[i])}}},getSegs:function(){},renderDrag:function(start,end,seg){},destroyDrag:function(){},documentDragStart:function(ev,ui){var _this=this;var dropDate=null;var dragListener;if(this.opt("droppable")){dragListener=new DragListener(this.coordMap,{cellOver:function(cell,date){dropDate=date;_this.renderDrag(date)},cellOut:function(){dropDate=null;_this.destroyDrag()}});$(document).one("dragstop",function(ev,ui){_this.destroyDrag();if(dropDate){_this.trigger("drop",ev.target,dropDate,ev,ui)}});dragListener.startDrag(ev)}},select:function(start,end,ev){this.unselect(ev);this.renderSelection(start,end);this.reportSelection(start,end,ev)},renderSelection:function(start,end){},reportSelection:function(start,end,ev){this.isSelected=true;this.trigger("select",null,start,end,ev)},unselect:function(ev){if(this.isSelected){this.isSelected=false;this.destroySelection();this.trigger("unselect",null,ev)}},destroySelection:function(){},documentMousedown:function(ev){var ignore;if(this.isSelected&&this.opt("unselectAuto")&&isPrimaryMouseButton(ev)){ignore=this.opt("unselectCancel");if(!ignore||!$(ev.target).closest(ignore).length){this.unselect(ev)}}}};function View(calendar){var t=this;t.calendar=calendar;t.opt=opt;t.trigger=trigger;t.isEventDraggable=isEventDraggable;t.isEventResizable=isEventResizable;t.eventDrop=eventDrop;t.eventResize=eventResize;var reportEventChange=calendar.reportEventChange;var options=calendar.options;var nextDayThreshold=moment.duration(options.nextDayThreshold);t.init();function opt(name){var v=options[name];if($.isPlainObject(v)&&!isForcedAtomicOption(name)){return smartProperty(v,t.name)}return v}function trigger(name,thisObj){return calendar.trigger.apply(calendar,[name,thisObj||t].concat(Array.prototype.slice.call(arguments,2),[t]))}function isEventDraggable(event){var source=event.source||{};return firstDefined(event.startEditable,source.startEditable,opt("eventStartEditable"),event.editable,source.editable,opt("editable"))}function isEventResizable(event){var source=event.source||{};return firstDefined(event.durationEditable,source.durationEditable,opt("eventDurationEditable"),event.editable,source.editable,opt("editable"))}t.getEventTimeText=function(event,formatStr){var start;var end;if(typeof event==="object"&&typeof formatStr==="object"){start=event;end=formatStr;formatStr=arguments[2]}else{start=event.start;end=event.end}formatStr=formatStr||opt("timeFormat");if(end&&opt("displayEventEnd")){return calendar.formatRange(start,end,formatStr)}else{return calendar.formatDate(start,formatStr)}};function eventDrop(el,event,newStart,ev){var mutateResult=calendar.mutateEvent(event,newStart,null);trigger("eventDrop",el,event,mutateResult.dateDelta,function(){mutateResult.undo();reportEventChange()},ev,{});reportEventChange()}function eventResize(el,event,newEnd,ev){var mutateResult=calendar.mutateEvent(event,null,newEnd);trigger("eventResize",el,event,mutateResult.durationDelta,function(){mutateResult.undo();reportEventChange()},ev,{});reportEventChange()}t.isHiddenDay=isHiddenDay;t.skipHiddenDays=skipHiddenDays;t.getCellsPerWeek=getCellsPerWeek;t.dateToCell=dateToCell;t.dateToDayOffset=dateToDayOffset;t.dayOffsetToCellOffset=dayOffsetToCellOffset;t.cellOffsetToCell=cellOffsetToCell;t.cellToDate=cellToDate;t.cellToCellOffset=cellToCellOffset;t.cellOffsetToDayOffset=cellOffsetToDayOffset;t.dayOffsetToDate=dayOffsetToDate;t.rangeToSegments=rangeToSegments;t.isMultiDayEvent=isMultiDayEvent;var hiddenDays=opt("hiddenDays")||[];var isHiddenDayHash=[];var cellsPerWeek;var dayToCellMap=[];var cellToDayMap=[];var isRTL=opt("isRTL");(function(){if(opt("weekends")===false){hiddenDays.push(0,6)}for(var dayIndex=0,cellIndex=0;dayIndex<7;dayIndex++){dayToCellMap[dayIndex]=cellIndex;isHiddenDayHash[dayIndex]=$.inArray(dayIndex,hiddenDays)!=-1;if(!isHiddenDayHash[dayIndex]){cellToDayMap[cellIndex]=dayIndex;cellIndex++}}cellsPerWeek=cellIndex;if(!cellsPerWeek){throw"invalid hiddenDays"}})();function isHiddenDay(day){if(moment.isMoment(day)){day=day.day()}return isHiddenDayHash[day]}function getCellsPerWeek(){return cellsPerWeek}function skipHiddenDays(date,inc,isExclusive){var out=date.clone();inc=inc||1;while(isHiddenDayHash[(out.day()+(isExclusive?inc:0)+7)%7]){out.add(inc,"days")}return out}function cellToDate(){var cellOffset=cellToCellOffset.apply(null,arguments);var dayOffset=cellOffsetToDayOffset(cellOffset);var date=dayOffsetToDate(dayOffset);return date}function cellToCellOffset(row,col){var colCnt=t.colCnt;var dis=isRTL?-1:1;var dit=isRTL?colCnt-1:0;if(typeof row=="object"){col=row.col;row=row.row}var cellOffset=row*colCnt+(col*dis+dit);return cellOffset}function cellOffsetToDayOffset(cellOffset){var day0=t.start.day();cellOffset+=dayToCellMap[day0];return Math.floor(cellOffset/cellsPerWeek)*7+cellToDayMap[(cellOffset%cellsPerWeek+cellsPerWeek)%cellsPerWeek]-day0}function dayOffsetToDate(dayOffset){return t.start.clone().add(dayOffset,"days")}function dateToCell(date){var dayOffset=dateToDayOffset(date);var cellOffset=dayOffsetToCellOffset(dayOffset);var cell=cellOffsetToCell(cellOffset);return cell}function dateToDayOffset(date){return date.clone().stripTime().diff(t.start,"days")}function dayOffsetToCellOffset(dayOffset){var day0=t.start.day();dayOffset+=day0;return Math.floor(dayOffset/7)*cellsPerWeek+dayToCellMap[(dayOffset%7+7)%7]-dayToCellMap[day0]}function cellOffsetToCell(cellOffset){var colCnt=t.colCnt;var dis=isRTL?-1:1;var dit=isRTL?colCnt-1:0;var row=Math.floor(cellOffset/colCnt);var col=(cellOffset%colCnt+colCnt)%colCnt*dis+dit;return{row:row,col:col}}function rangeToSegments(start,end){var rowCnt=t.rowCnt;var colCnt=t.colCnt;var segments=[];var dayRange=computeDayRange(start,end);var rangeDayOffsetStart=dateToDayOffset(dayRange.start);var rangeDayOffsetEnd=dateToDayOffset(dayRange.end);var rangeCellOffsetFirst=dayOffsetToCellOffset(rangeDayOffsetStart);var rangeCellOffsetLast=dayOffsetToCellOffset(rangeDayOffsetEnd)-1;for(var row=0;row<rowCnt;row++){var rowCellOffsetFirst=row*colCnt;var rowCellOffsetLast=rowCellOffsetFirst+colCnt-1;var segmentCellOffsetFirst=Math.max(rangeCellOffsetFirst,rowCellOffsetFirst);var segmentCellOffsetLast=Math.min(rangeCellOffsetLast,rowCellOffsetLast);if(segmentCellOffsetFirst<=segmentCellOffsetLast){var segmentCellFirst=cellOffsetToCell(segmentCellOffsetFirst);var segmentCellLast=cellOffsetToCell(segmentCellOffsetLast);var cols=[segmentCellFirst.col,segmentCellLast.col].sort();var isStart=cellOffsetToDayOffset(segmentCellOffsetFirst)==rangeDayOffsetStart;var isEnd=cellOffsetToDayOffset(segmentCellOffsetLast)+1==rangeDayOffsetEnd;segments.push({row:row,leftCol:cols[0],rightCol:cols[1],isStart:isStart,isEnd:isEnd})}}return segments}function computeDayRange(start,end){var startDay=start.clone().stripTime();var endDay;var endTimeMS;if(end){endDay=end.clone().stripTime();endTimeMS=+end.time();if(endTimeMS&&endTimeMS>=nextDayThreshold){endDay.add(1,"days")}}if(!end||endDay<=startDay){endDay=startDay.clone().add(1,"days")}return{start:startDay,end:endDay}}function isMultiDayEvent(event){var range=computeDayRange(event.start,event.end);return range.end.diff(range.start,"days")>1}}function BasicView(calendar){View.call(this,calendar);this.dayGrid=new DayGrid(this);this.coordMap=this.dayGrid.coordMap}BasicView.prototype=createObject(View.prototype);$.extend(BasicView.prototype,{dayGrid:null,dayNumbersVisible:false,weekNumbersVisible:false,weekNumberWidth:null,headRowEl:null,render:function(rowCnt,colCnt,dayNumbersVisible){this.rowCnt=rowCnt;
this.colCnt=colCnt;this.dayNumbersVisible=dayNumbersVisible;this.weekNumbersVisible=this.opt("weekNumbers");this.dayGrid.numbersVisible=this.dayNumbersVisible||this.weekNumbersVisible;this.el.addClass("fc-basic-view").html(this.renderHtml());this.headRowEl=this.el.find("thead .fc-row");this.scrollerEl=this.el.find(".fc-day-grid-container");this.dayGrid.coordMap.containerEl=this.scrollerEl;this.dayGrid.el=this.el.find(".fc-day-grid");this.dayGrid.render(this.hasRigidRows());View.prototype.render.call(this)},destroy:function(){this.dayGrid.destroy();View.prototype.destroy.call(this)},renderHtml:function(){return""+"<table>"+"<thead>"+"<tr>"+'<td class="'+this.widgetHeaderClass+'">'+this.dayGrid.headHtml()+"</td>"+"</tr>"+"</thead>"+"<tbody>"+"<tr>"+'<td class="'+this.widgetContentClass+'">'+'<div class="fc-day-grid-container">'+'<div class="fc-day-grid"/>'+"</div>"+"</td>"+"</tr>"+"</tbody>"+"</table>"},headIntroHtml:function(){if(this.weekNumbersVisible){return""+'<th class="fc-week-number '+this.widgetHeaderClass+'" '+this.weekNumberStyleAttr()+">"+"<span>"+htmlEscape(this.opt("weekNumberTitle"))+"</span>"+"</th>"}},numberIntroHtml:function(row){if(this.weekNumbersVisible){return""+'<td class="fc-week-number" '+this.weekNumberStyleAttr()+">"+"<span>"+this.calendar.calculateWeekNumber(this.cellToDate(row,0))+"</span>"+"</td>"}},dayIntroHtml:function(){if(this.weekNumbersVisible){return'<td class="fc-week-number '+this.widgetContentClass+'" '+this.weekNumberStyleAttr()+"></td>"}},introHtml:function(){if(this.weekNumbersVisible){return'<td class="fc-week-number" '+this.weekNumberStyleAttr()+"></td>"}},numberCellHtml:function(row,col,date){var classes;if(!this.dayNumbersVisible){return"<td/>"}classes=this.dayGrid.getDayClasses(date);classes.unshift("fc-day-number");return""+'<td class="'+classes.join(" ")+'" data-date="'+date.format()+'">'+date.date()+"</td>"},weekNumberStyleAttr:function(){if(this.weekNumberWidth!==null){return'style="width:'+this.weekNumberWidth+'px"'}return""},hasRigidRows:function(){var eventLimit=this.opt("eventLimit");return eventLimit&&typeof eventLimit!=="number"},updateWidth:function(){if(this.weekNumbersVisible){this.weekNumberWidth=matchCellWidths(this.el.find(".fc-week-number"))}},setHeight:function(totalHeight,isAuto){var eventLimit=this.opt("eventLimit");var scrollerHeight;unsetScroller(this.scrollerEl);uncompensateScroll(this.headRowEl);this.dayGrid.destroySegPopover();if(eventLimit&&typeof eventLimit==="number"){this.dayGrid.limitRows(eventLimit)}scrollerHeight=this.computeScrollerHeight(totalHeight);this.setGridHeight(scrollerHeight,isAuto);if(eventLimit&&typeof eventLimit!=="number"){this.dayGrid.limitRows(eventLimit)}if(!isAuto&&setPotentialScroller(this.scrollerEl,scrollerHeight)){compensateScroll(this.headRowEl,getScrollbarWidths(this.scrollerEl));scrollerHeight=this.computeScrollerHeight(totalHeight);this.scrollerEl.height(scrollerHeight);this.restoreScroll()}},setGridHeight:function(height,isAuto){if(isAuto){undistributeHeight(this.dayGrid.rowEls)}else{distributeHeight(this.dayGrid.rowEls,height,true)}},renderEvents:function(events){this.dayGrid.renderEvents(events);this.updateHeight();View.prototype.renderEvents.call(this,events)},getSegs:function(){return this.dayGrid.getSegs()},destroyEvents:function(){View.prototype.destroyEvents.call(this);this.recordScroll();this.dayGrid.destroyEvents()},renderDrag:function(start,end,seg){return this.dayGrid.renderDrag(start,end,seg)},destroyDrag:function(){this.dayGrid.destroyDrag()},renderSelection:function(start,end){this.dayGrid.renderSelection(start,end)},destroySelection:function(){this.dayGrid.destroySelection()}});setDefaults({fixedWeekCount:true});fcViews.month=MonthView;function MonthView(calendar){BasicView.call(this,calendar)}MonthView.prototype=createObject(BasicView.prototype);$.extend(MonthView.prototype,{name:"month",incrementDate:function(date,delta){return date.clone().stripTime().add(delta,"months").startOf("month")},render:function(date){var rowCnt;this.intervalStart=date.clone().stripTime().startOf("month");this.intervalEnd=this.intervalStart.clone().add(1,"months");this.start=this.intervalStart.clone();this.start=this.skipHiddenDays(this.start);this.start.startOf("week");this.start=this.skipHiddenDays(this.start);this.end=this.intervalEnd.clone();this.end=this.skipHiddenDays(this.end,-1,true);this.end.add((7-this.end.weekday())%7,"days");this.end=this.skipHiddenDays(this.end,-1,true);rowCnt=Math.ceil(this.end.diff(this.start,"weeks",true));if(this.isFixedWeeks()){this.end.add(6-rowCnt,"weeks");rowCnt=6}this.title=this.calendar.formatDate(this.intervalStart,this.opt("titleFormat"));BasicView.prototype.render.call(this,rowCnt,this.getCellsPerWeek(),true)},setGridHeight:function(height,isAuto){isAuto=isAuto||this.opt("weekMode")==="variable";if(isAuto){height*=this.rowCnt/6}distributeHeight(this.dayGrid.rowEls,height,!isAuto)},isFixedWeeks:function(){var weekMode=this.opt("weekMode");if(weekMode){return weekMode==="fixed"}return this.opt("fixedWeekCount")}});fcViews.basicWeek=BasicWeekView;function BasicWeekView(calendar){BasicView.call(this,calendar)}BasicWeekView.prototype=createObject(BasicView.prototype);$.extend(BasicWeekView.prototype,{name:"basicWeek",incrementDate:function(date,delta){return date.clone().stripTime().add(delta,"weeks").startOf("week")},render:function(date){this.intervalStart=date.clone().stripTime().startOf("week");this.intervalEnd=this.intervalStart.clone().add(1,"weeks");this.start=this.skipHiddenDays(this.intervalStart);this.end=this.skipHiddenDays(this.intervalEnd,-1,true);this.title=this.calendar.formatRange(this.start,this.end.clone().subtract(1),this.opt("titleFormat")," — ");BasicView.prototype.render.call(this,1,this.getCellsPerWeek(),false)}});fcViews.basicDay=BasicDayView;function BasicDayView(calendar){BasicView.call(this,calendar)}BasicDayView.prototype=createObject(BasicView.prototype);$.extend(BasicDayView.prototype,{name:"basicDay",incrementDate:function(date,delta){var out=date.clone().stripTime().add(delta,"days");out=this.skipHiddenDays(out,delta<0?-1:1);return out},render:function(date){this.start=this.intervalStart=date.clone().stripTime();this.end=this.intervalEnd=this.start.clone().add(1,"days");this.title=this.calendar.formatDate(this.start,this.opt("titleFormat"));BasicView.prototype.render.call(this,1,1,false)}});setDefaults({allDaySlot:true,allDayText:"all-day",scrollTime:"06:00:00",slotDuration:"00:30:00",axisFormat:generateAgendaAxisFormat,timeFormat:{agenda:generateAgendaTimeFormat},minTime:"00:00:00",maxTime:"24:00:00",slotEventOverlap:true});var AGENDA_ALL_DAY_EVENT_LIMIT=5;function generateAgendaAxisFormat(options,langData){return langData.longDateFormat("LT").replace(":mm","(:mm)").replace(/(\Wmm)$/,"($1)").replace(/\s*a$/i,"a")}function generateAgendaTimeFormat(options,langData){return langData.longDateFormat("LT").replace(/\s*a$/i,"")}function AgendaView(calendar){View.call(this,calendar);this.timeGrid=new TimeGrid(this);if(this.opt("allDaySlot")){this.dayGrid=new DayGrid(this);this.coordMap=new ComboCoordMap([this.dayGrid.coordMap,this.timeGrid.coordMap])}else{this.coordMap=this.timeGrid.coordMap}}AgendaView.prototype=createObject(View.prototype);$.extend(AgendaView.prototype,{timeGrid:null,dayGrid:null,axisWidth:null,noScrollRowEls:null,bottomRuleEl:null,bottomRuleHeight:null,render:function(colCnt){this.rowCnt=1;this.colCnt=colCnt;this.el.addClass("fc-agenda-view").html(this.renderHtml());this.scrollerEl=this.el.find(".fc-time-grid-container");this.timeGrid.coordMap.containerEl=this.scrollerEl;this.timeGrid.el=this.el.find(".fc-time-grid");this.timeGrid.render();this.bottomRuleEl=$('<hr class="'+this.widgetHeaderClass+'"/>').appendTo(this.timeGrid.el);if(this.dayGrid){this.dayGrid.el=this.el.find(".fc-day-grid");this.dayGrid.render();this.dayGrid.bottomCoordPadding=this.dayGrid.el.next("hr").outerHeight()}this.noScrollRowEls=this.el.find(".fc-row:not(.fc-scroller *)");View.prototype.render.call(this);this.resetScroll()},destroy:function(){this.timeGrid.destroy();if(this.dayGrid){this.dayGrid.destroy()}View.prototype.destroy.call(this)},renderHtml:function(){return""+"<table>"+"<thead>"+"<tr>"+'<td class="'+this.widgetHeaderClass+'">'+this.timeGrid.headHtml()+"</td>"+"</tr>"+"</thead>"+"<tbody>"+"<tr>"+'<td class="'+this.widgetContentClass+'">'+(this.dayGrid?'<div class="fc-day-grid"/>'+'<hr class="'+this.widgetHeaderClass+'"/>':"")+'<div class="fc-time-grid-container">'+'<div class="fc-time-grid"/>'+"</div>"+"</td>"+"</tr>"+"</tbody>"+"</table>"},headIntroHtml:function(){var date;var weekNumber;var weekTitle;var weekText;if(this.opt("weekNumbers")){date=this.cellToDate(0,0);weekNumber=this.calendar.calculateWeekNumber(date);weekTitle=this.opt("weekNumberTitle");if(this.opt("isRTL")){weekText=weekNumber+weekTitle}else{weekText=weekTitle+weekNumber}return""+'<th class="fc-axis fc-week-number '+this.widgetHeaderClass+'" '+this.axisStyleAttr()+">"+"<span>"+htmlEscape(weekText)+"</span>"+"</th>"}else{return'<th class="fc-axis '+this.widgetHeaderClass+'" '+this.axisStyleAttr()+"></th>"}},dayIntroHtml:function(){return""+'<td class="fc-axis '+this.widgetContentClass+'" '+this.axisStyleAttr()+">"+"<span>"+(this.opt("allDayHtml")||htmlEscape(this.opt("allDayText")))+"</span>"+"</td>"},slotBgIntroHtml:function(){return'<td class="fc-axis '+this.widgetContentClass+'" '+this.axisStyleAttr()+"></td>"},introHtml:function(){return'<td class="fc-axis" '+this.axisStyleAttr()+"></td>"},axisStyleAttr:function(){if(this.axisWidth!==null){return'style="width:'+this.axisWidth+'px"'}return""},updateSize:function(isResize){if(isResize){this.timeGrid.resize()}View.prototype.updateSize.call(this,isResize)},updateWidth:function(){this.axisWidth=matchCellWidths(this.el.find(".fc-axis"))},setHeight:function(totalHeight,isAuto){var eventLimit;var scrollerHeight;if(this.bottomRuleHeight===null){this.bottomRuleHeight=this.bottomRuleEl.outerHeight()}this.bottomRuleEl.hide();this.scrollerEl.css("overflow","");unsetScroller(this.scrollerEl);uncompensateScroll(this.noScrollRowEls);if(this.dayGrid){this.dayGrid.destroySegPopover();eventLimit=this.opt("eventLimit");if(eventLimit&&typeof eventLimit!=="number"){eventLimit=AGENDA_ALL_DAY_EVENT_LIMIT}if(eventLimit){this.dayGrid.limitRows(eventLimit)}}if(!isAuto){scrollerHeight=this.computeScrollerHeight(totalHeight);if(setPotentialScroller(this.scrollerEl,scrollerHeight)){compensateScroll(this.noScrollRowEls,getScrollbarWidths(this.scrollerEl));scrollerHeight=this.computeScrollerHeight(totalHeight);this.scrollerEl.height(scrollerHeight);this.restoreScroll()}else{this.scrollerEl.height(scrollerHeight).css("overflow","hidden");this.bottomRuleEl.show()}}},resetScroll:function(){var _this=this;var scrollTime=moment.duration(this.opt("scrollTime"));var top=this.timeGrid.computeTimeTop(scrollTime);top=Math.ceil(top);if(top){top++}function scroll(){_this.scrollerEl.scrollTop(top)}scroll();setTimeout(scroll,0)},renderEvents:function(events){var dayEvents=[];var timedEvents=[];var daySegs=[];var timedSegs;var i;for(i=0;i<events.length;i++){if(events[i].allDay){dayEvents.push(events[i])}else{timedEvents.push(events[i])}}timedSegs=this.timeGrid.renderEvents(timedEvents);if(this.dayGrid){daySegs=this.dayGrid.renderEvents(dayEvents)}this.updateHeight();View.prototype.renderEvents.call(this,events)},getSegs:function(){return this.timeGrid.getSegs().concat(this.dayGrid?this.dayGrid.getSegs():[])},destroyEvents:function(){View.prototype.destroyEvents.call(this);this.recordScroll();this.timeGrid.destroyEvents();if(this.dayGrid){this.dayGrid.destroyEvents()}},renderDrag:function(start,end,seg){if(start.hasTime()){return this.timeGrid.renderDrag(start,end,seg)}else if(this.dayGrid){return this.dayGrid.renderDrag(start,end,seg)}},destroyDrag:function(){this.timeGrid.destroyDrag();if(this.dayGrid){this.dayGrid.destroyDrag()}},renderSelection:function(start,end){if(start.hasTime()||end.hasTime()){this.timeGrid.renderSelection(start,end)}else if(this.dayGrid){this.dayGrid.renderSelection(start,end)}},destroySelection:function(){this.timeGrid.destroySelection();if(this.dayGrid){this.dayGrid.destroySelection()}}});fcViews.agendaWeek=AgendaWeekView;function AgendaWeekView(calendar){AgendaView.call(this,calendar)}AgendaWeekView.prototype=createObject(AgendaView.prototype);$.extend(AgendaWeekView.prototype,{name:"agendaWeek",incrementDate:function(date,delta){return date.clone().stripTime().add(delta,"weeks").startOf("week")},render:function(date){this.intervalStart=date.clone().stripTime().startOf("week");this.intervalEnd=this.intervalStart.clone().add(1,"weeks");this.start=this.skipHiddenDays(this.intervalStart);this.end=this.skipHiddenDays(this.intervalEnd,-1,true);this.title=this.calendar.formatRange(this.start,this.end.clone().subtract(1),this.opt("titleFormat")," — ");AgendaView.prototype.render.call(this,this.getCellsPerWeek())}});fcViews.agendaDay=AgendaDayView;function AgendaDayView(calendar){AgendaView.call(this,calendar)}AgendaDayView.prototype=createObject(AgendaView.prototype);$.extend(AgendaDayView.prototype,{name:"agendaDay",incrementDate:function(date,delta){var out=date.clone().stripTime().add(delta,"days");out=this.skipHiddenDays(out,delta<0?-1:1);return out},render:function(date){this.start=this.intervalStart=date.clone().stripTime();this.end=this.intervalEnd=this.start.clone().add(1,"days");this.title=this.calendar.formatDate(this.start,this.opt("titleFormat"));AgendaView.prototype.render.call(this,1)}})});